(()=>{function ct(f){if(!navigator.clipboard||!navigator.permissions){let s=document.createElement("textarea");s.value=f,s.style.top="0",s.style.left="0",s.style.position="fixed",document.body.appendChild(s);try{s.focus(),s.select(),document.execCommand("copy")}catch(r){}document.body.removeChild(s);return}navigator.clipboard.writeText(f)}var xi=window.requestIdleCallback;var Ci=/bot|crawl|spider/i.test(navigator.userAgent);function ie(f,s,r){return"https://raw.githubusercontent.com/"+f+"/"+(r||"HEAD")+"/"+s}function o(f,s,r){ajax({method:"POST",url:f,data:s,success:a=>{if(a=JSON.parse(a),a.error){r(a.error);return}r(null,a)},error:a=>{if(a.error){r(a.error);return}r(a)}})}var Pi=ie("obsidianmd/obsidian-releases","community-plugins.json");var Ri=ie("obsidianmd/obsidian-releases","community-plugin-stats.json");var Ai=ie("obsidianmd/obsidian-releases","community-css-themes.json");var k=class{static encodeUrlQuery(s){if(!s)return"";let r=[];for(let a in s)s.hasOwnProperty(a)&&s[a]&&(s[a]===!0?r.push(encodeURIComponent(a)):r.push(encodeURIComponent(a)+"="+encodeURIComponent(s[a])));return r.join("&")}static decodeUrlQuery(s){let r={};if(!s||s.trim()==="")return r;let a=s.split("&");for(let E=0;E<a.length;E++){let b=a[E].split("=");if(b.length>=1&&b[0]){let _=decodeURIComponent(b[0]);b.length===2?r[_]=decodeURIComponent(b[1]):r[_]=""}}return r}static decodeUrl(s){s||(s="");let r=s.split("#"),a=r.length>1?r[1]:"",E=r[0].split("?"),b=E.length>1?E[1]:"";return{path:E[0],query:k.decodeUrlQuery(b),hash:k.decodeUrlQuery(a)}}};var dt=location.host.startsWith("127.0.0.1")||location.host.startsWith("localhost"),u="https://api.obsidian.md";dt&&(u="http://127.0.0.1:3000");var ti=u+"/user/info",ni=u+"/user/signin",ii=u+"/user/signup",si=u+"/user/signout",oi=u+"/user/forgetpass",li=u+"/user/resetpass",ai=u+"/user/changename",ri=u+"/user/changeemail",ci=u+"/user/changepass",di=u+"/user/deleteaccount",ui=u+"/subscription/list",mi=u+"/subscription/pay",hi=u+"/subscription/stripe/end",se=u+"/subscription/price",fi=u+"/subscription/business/rename",pi=u+"/subscription/business/reduce",M=u+"/subscription/renew",yi=u+"/subscription/publish/reduce",Ei=u+"/subscription/paymentmethod",wi=u+"/subscription/stripe/paymentmethod",gi=u+"/subscription/role/discord",vi=u+"/subscription/role/forum",bi=u+"/subscription/invoice/list",Ti=u+"/subscription/invoice/refund",ut="pk_live_vqeOYADfYPpqKDT5FtAqCNBP00a9WEhYa6";dt&&(ut="pk_test_y7CBP7qLG6kSU9sdcHV5S2db0052OC4wR8");function Ce(){history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):location.hash=""}function Y(f){let s=(f/100).toFixed(2).toString().toString().split(".");return s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),s.join(".")}var W=location.hash;W&&W.length>1&&(W=W.substr(1));var $=location.search;$&&$.length>1&&($=$.substr(1));window.setTimeout(()=>{ready(()=>{let f=fish(".login-form"),s=fish(".login-form .message.mod-error"),r=fish(".signup-form"),a=fish(".signup-form .message.mod-error"),E=fish(".welcome"),b=fish("#labeled-input-email"),_=fish("#labeled-input-password"),mt=fish(".signup-name"),ht=fish(".obsidian-signup-email"),ft=fish(".signup-password"),pt=fish(".welcome-name"),yt=fish(".welcome-email"),Et=fish(".js-change-email"),wt=fish(".modal-container.mod-change-email"),gt=fish(".change-email-new-email"),vt=fish(".change-email-password"),bt=fish(".js-confirm-change-email"),S=fish(".modal-container.mod-change-email .message.mod-error"),Tt=fish(".js-change-name"),Lt=fish(".modal-container.mod-change-name"),xt=fish(".change-name-new-name"),Ct=fish(".js-confirm-change-name"),j=fish(".modal-container.mod-change-name .message.mod-error"),Mt=fish(".js-change-password"),St=fish(".modal-container.mod-change-password"),It=fish(".change-password-old-password"),Pt=fish(".change-password-new-password"),Rt=fish(".js-confirm-change-password"),I=fish(".modal-container.mod-change-password .message.mod-error"),At=fish(".js-delete-account"),Dt=fish(".modal-container.mod-delete-account"),kt=fish(".delete-account-password"),_t=fish(".delete-account-email"),Nt=fish(".js-confirm-delete-account"),P=fish(".modal-container.mod-delete-account .message.mod-error"),O=fish(".modal-container.mod-change-info-success"),Ut=fish(".js-logout"),Me=fish(".card.mod-publish"),Se=fish(".card.mod-sync"),Ie=fish(".publish-site-num"),Pe=fish(".publish-renew-site-num"),Ft=fishAll(".publish-renewal-time"),Ht=fish(".publish-renew-info-renewing"),Re=fish(".publish-renew-info-not-renewing"),Yt=fishAll(".js-view-payment-info"),jt=fishAll(".js-open-change-payment"),Ae=fish(".current-card-info"),De=fish(".modal-container.mod-change-payment-method"),Ot=fish(".modal-container.mod-change-payment-method .payment-form"),Bt=fish(".js-change-number-of-publish-sites"),oe=fish(".js-reduce-number-of-publish-sites"),ke=fish(".js-change-publish-to-monthly"),_e=fish(".js-change-publish-to-yearly"),Ne=fish(".setting-item-description.mod-publish-frequency"),Ue=fish(".publish-reduce-sites-num"),qt=fish(".js-update-reduce-sites"),Fe=fish(".js-stop-publish-auto-renewal"),Xt=fish(".commercial-license-pitch"),Gt=fish(".existing-commercial-license"),He=fish(".business-name-input"),T=fish(".commercial-license-key"),Kt=fish(".commercial-license-company-name"),Wt=fishAll(".commercial-license-seat-number"),Ye=fish(".card.mod-commercial-license"),le=fish(".modal-container.mod-commercial-license"),$t=fish(".modal-container.mod-commercial-license .modal-title"),je=fish(".modal-container.mod-personal-license"),Qt=fish(".catalyst-tier"),Oe=fish(".catalyst-upgrade-button"),Vt=fishAll(".js-close-modal, .modal-close-button, .modal-bg"),Be=fish(".card.mod-catalyst"),qe=fish('.card[data-tier="insider"]'),zt=fish('.card[data-tier="supporter"]'),ae=fishAll(".modal-container.mod-personal-license .card"),Jt=fish(".modal-container.mod-personal-license .payment-form"),Zt=fish(".modal-container.mod-commercial-license .payment-form"),en=fish(".commercial-license-auto-renewal"),m=fish(".loader-cube"),tn=fish(".js-go-to-signup"),nn=fish(".js-go-to-login"),sn=fish(".js-go-to-forgot-pass"),Xe=fish(".forgot-pass-form"),re=fish(".forgot-pass-form .message.mod-success"),R=fish(".forgot-pass-form .message.mod-error"),on=fish(".forgot-pass-email"),Ge=fish(".reset-pass-form"),ln=fish(".forgot-pass-email-container"),an=fish(".reset-pass-password"),ce=fish(".reset-pass-form .message.mod-success"),B=fish(".reset-pass-form .message.mod-error"),rn=fish(".js-request-forgot"),Ke=fish(".modal-container.mod-personal-license .payment-container"),N=fish(".commercial-license-seat"),l=null,cn=fish(".js-upgrade-publish"),Q=fish(".modal-container.mod-choose-publish-plan"),dn=fish(".modal-container.mod-publish-reduce-sites"),un=fish(".modal-container.mod-view-payment-method"),de=Q.findAll(".card"),We=Q.find(".publish-sites-num"),mn=fish(".modal-container.mod-choose-publish-plan .payment-form"),hn=fishAll(".wechat-pay-image"),fn=fish(".modal-container.mod-wechat-pay"),pn=fishAll(".paypal-pay-image"),yn=fish(".modal-container.mod-paypal-pay"),En=fish(".js-open-unlimited"),$e=fish(".modal-container.mod-donation"),wn=fish(".modal-container.mod-donation .payment-form"),Qe=fish(".donation-amount-input"),gn=fish(".donation-amount"),vn=fishAll(".modal-container"),bn=fish(".js-upgrade-sync"),V=fish(".modal-container.mod-choose-sync-plan"),ue=V.findAll(".card"),Tn=V.find(".payment-form"),me=fish(".js-change-sync-to-monthly"),he=fish(".js-change-sync-to-yearly"),fe=fish(".js-stop-sync-auto-renewal"),Ln=fishAll(".sync-renewal-time"),Ve=fish(".sync-renew-info-renewing"),pe=fish(".sync-renew-info-not-renewing"),ze=fish(".setting-item-description.mod-sync-frequency"),xn=fishAll(".commercial-renewal-time"),ye=fish(".js-resume-commercial-auto-renewal"),z=fish(".js-stop-commercial-auto-renewal"),Ee=fish(".commercial-renew-info-renewing"),J=fish(".commercial-renew-info-not-renewing"),Cn=fishAll(".commercial-license-expiry-time"),Mn=fishAll(".checkbox-container"),Sn=fishAll(".claim-discord-badge-button"),In=fishAll(".claim-forum-badge-button"),Pn=fish(".modal-container.mod-discord-success"),Rn=fish(".modal-container.mod-discord-failure"),An=fish(".modal-container.mod-forum-success"),Dn=fish(".modal-container.mod-forum-failure"),kn=fish(".modal-container.mod-discord-failure .message.mod-error"),_n=fish(".modal-container.mod-forum-failure .message.mod-error"),Nn=fish(".modal-container.mod-catalyst-payment-success"),Un=fish(".modal-container.mod-publish-payment-success"),Fn=fish(".modal-container.mod-sync-payment-success"),Hn=fish(".js-commercial-license-change-seat"),Yn=fish(".js-commercial-license-reduce-seat"),jn=fish(".modal-container.mod-commercial-license-reduce-seats"),On=fish(".commercial-license-reduce-seat-input"),Bn=fish(".js-update-reduce-seats"),A=fish(".modal-container.mod-commercial-license-reduce-seats .payment-error"),qn={base:{color:"#dcddde",iconColor:"#dcddde",fontFamily:"Inter, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#888888"}},invalid:{fontFamily:"Inter, sans-serif",color:"#fa755a",iconColor:"#fa755a"}},q="",p=null,w=null,U=null,Z=!1,Je=null,Ze=null,v=!1,C=null,F=!1,we=window.Stripe(ut),h=we.elements().create("card",{style:qn}),L=()=>{if(v){window.location.reload();return}h.unmount(),Ke.hide(),vn.forEach(t=>t.hide()),ae.forEach(t=>t.removeClass("is-selected")),v=!1},g=k.decodeUrlQuery(W);if(g.mode&&g.mode==="signup")Ce(),m.hide(),r.show(),Z=!0;else if(g.mode&&g.mode==="forgotpass")Ce(),m.hide(),Xe.show(),Z=!0;else if(g.hasOwnProperty("forgetpw")&&g.id&&g.key)Ce(),Je=g.id,Ze=g.key,m.hide(),Ge.show(),Z=!0;else if(g.stripe&&g.stripe==="complete"){let t=g.session}let et=k.decodeUrlQuery($);et.code&&o(gi,{code:et.code},(t,e)=>{t?(kn.setText(t),Rn.show()):Pn.show(),window.history.replaceState(null,null,window.location.pathname)}),Jt.addEventListener("submit",function(t){t.preventDefault(),fishAll(".payment-error").forEach(e=>e.hide()),D(!0),G(e=>X(h,e))}),Zt.addEventListener("submit",function(t){if(t.preventDefault(),fishAll(".payment-error").forEach(n=>n.hide()),!He.value&&!F){l.setText("Please enter a business name."),l.show();return}F?U=C.renew:en.hasClass("is-enabled")?U="yearly":U="",D(!0),G(n=>X(h,n))});let X=function(t,e){l.hide(),we.confirmCardPayment(e,{payment_method:{card:t}}).then(function(n){n.error?(D(!1),l.setText(n.error.message),l.show()):Xn(n.paymentIntent.id)})},ee=function(t,e){let n=e.find(".payment-line.mod-subtotal"),i=e.find(".payment-line.mod-subtotal .payment-desc"),c=e.find(".payment-line.mod-subtotal .payment-amount"),d=e.find(".payment-line.mod-discount"),x=e.find(".payment-line.mod-discount .payment-desc"),y=e.find(".payment-line.mod-discount .payment-amount"),H=e.find(".payment-line.mod-tax"),K=e.find(".payment-line.mod-tax .payment-desc"),be=e.find(".payment-line.mod-tax .payment-amount"),ne=e.find(".payment-line.mod-credit"),Te=e.find(".payment-line.mod-credit .payment-amount"),st=e.find(".payment-line.mod-total .payment-desc"),Jn=e.find(".payment-line.mod-total .payment-amount"),{subtotal:ot,desc:lt,tax:Le,taxDesc:Zn,discount:xe,discountDesc:ei,creditUsed:at,total:rt}=t;xe===0?d.hide():(d.show(),y.setText(Y(xe)),x.setText(ei||"")),Le===0?H.hide():(H.show(),be.setText(Y(Le)),K.setText(Zn||"")),ot===rt&&xe===0&&Le===0?(n.hide(),st.setText(lt)):(n.show(),c.setText(Y(ot)),i.setText(lt||""),st.setText("Total")),Te.setText(Y(at)),ne.toggle(at!==0),Jn.setText(Y(rt))},Xn=function(t){o(hi,{intent_id:t},(e,n)=>{if(D(!1),e)l.setText(e),l.show();else{let i=He.value;p==="business"&&!F?o(fi,{company:i},(c,d)=>{c?(l.setText(c),l.show()):window.location.reload()}):p==="catalyst"?(L(),v=!0,Nn.show()):p==="publish"?(L(),v=!0,Un.show()):p==="sync"?(L(),v=!0,Fn.show()):window.location.reload()}})},D=function(t){t?(fishAll("button.submit").forEach(e=>e.addClass("mod-disabled")),fishAll(".spinner").forEach(e=>e.removeClass("hidden")),fishAll(".button-text").forEach(e=>e.addClass("hidden"))):(fishAll("button.submit").forEach(e=>e.removeClass("mod-disabled")),fishAll(".spinner").forEach(e=>e.addClass("hidden")),fishAll(".button-text").forEach(e=>e.removeClass("hidden")))},Gn=()=>{o(ti,{},(t,e)=>{t?Z||(m.hide(),f.show()):(pt.setText(e.name),yt.setText(e.email),e.donation&&gn.setText(Y(e.donation)),r.hide(),m.hide(),E.show(),e.license&&(q=e.license),q?(Be.addClass("is-active"),Qt.setText(e.license),q!=="vip"&&(Oe.addEventListener("click",()=>{l=fish(".modal-container.mod-personal-license .payment-error"),je.show()}),Oe.show(),q==="supporter"?(qe.hide(),zt.hide()):q==="insider"&&qe.hide())):Be.addEventListener("click",()=>{l=fish(".modal-container.mod-personal-license .payment-error"),je.show()}))})},Kn=()=>{o(ui,{},(t,e)=>{if(!t){if(e.business&&e.business!==null&&e.business.expiry>=Date.now()){C=e.business,T.setText(C.key),Kt.setText(C.company);let n=C.seats,i=n===1?"1 seat":n+" seats";Wt.forEach(c=>c.setText(i)),Cn.forEach(c=>c.setText(new Date(C.expiry).toLocaleDateString())),Xt.hide(),Gt.show()}else Ye.addEventListener("click",()=>{p="business",w=parseInt(N.value).toString(),l=fish(".modal-container.mod-commercial-license .payment-error"),le.show(),h.mount(".modal-container.mod-commercial-license .card-element"),ge()});if(e.publish){let{sites:n,renew:i,renew_sites:c,expiry_ts:d,earlybird:x}=e.publish;if(d>=Date.now()){if(Me.addClass("is-active"),n===1?Ie.setText("1 site"):Ie.setText(`${n} sites`),c===1?(Pe.setText("1 site"),oe.hide()):(Pe.setText(`${c} sites`),oe.show()),d){let H=new Date(d);Ft.forEach(K=>K.setText(`on ${H.toLocaleDateString()}`))}Re.hide();let y=document.createDocumentFragment();i==="yearly"?(_e.hide(),y.createSpan({text:"You're currently on a "}),y.createSpan({cls:"u-pop",text:"yearly"}),y.createSpan({text:" plan."})):i==="monthly"?(ke.hide(),y.createSpan({text:"You're currently on a "}),y.createSpan({cls:"u-pop",text:"monthly"}),y.createSpan({text:" plan."})):i===""&&(Fe.hide(),Re.show(),Ht.hide(),y.createSpan({text:"You're not currently being renewed."})),Ne.empty(),Ne.appendChild(y),Ue.value=n}x===!0&&(fish(".publish-yearly-price-per-month").setText("8"),fish(".publish-yearly-price-per-year").setText("96"),fish(".publish-monthly-price-per-month").setText("10"),fish(".publish-monthly-price-per-year").setText("120"),Me.addClass("is-early-bird"))}if(e.sync){let{renew:n,expiry_ts:i,earlybird:c}=e.sync;if(i>=Date.now()){if(Se.addClass("is-active"),i){let x=new Date(i);Ln.forEach(y=>y.setText(`on ${x.toLocaleDateString()}`))}pe.hide(),n==="yearly"||(n==="monthly"?me.hide():n===""&&(fe.hide(),pe.show(),Ve.hide()));let d=document.createDocumentFragment();n==="yearly"?(he.hide(),d.createSpan({text:"You're currently on a "}),d.createSpan({cls:"u-pop",text:"yearly"}),d.createSpan({text:" plan."})):n==="monthly"?(me.hide(),d.createSpan({text:"You're currently on a "}),d.createSpan({cls:"u-pop",text:"monthly"}),d.createSpan({text:" plan."})):n===""&&(fe.hide(),pe.show(),Ve.hide(),d.createSpan({text:"You're not currently being renewed."})),ze.empty(),ze.appendChild(d)}c===!0&&(fish(".sync-yearly-price-per-month").setText("4"),fish(".sync-yearly-price-per-year").setText("48"),fish(".sync-monthly-price-per-month").setText("5"),fish(".sync-monthly-price-per-year").setText("60"),Se.addClass("is-early-bird"))}if(e.business){let{renew:n,expiry:i}=e.business;if(i>=Date.now()){if(Ye.addClass("is-active"),i){let c=new Date(i);xn.forEach(d=>d.setText(`on ${c.toLocaleDateString()}`))}J.hide(),n==="yearly"?(ye.hide(),z.show(),J.hide(),Ee.show()):n===""&&(ye.show(),z.hide(),J.show(),Ee.hide()),n==="yearly"?he.hide():n===""&&(z.hide(),J.show(),Ee.hide())}}}})},Wn=()=>{s.hide(),f.hide(),m.show();let t=b.value,e=_.value,n=!1;if(t===""?(s.setText("Email cannot be empty."),n=!0):t.indexOf("@")===-1?(s.setText("Email is not valid."),n=!0):e===""&&(s.setText("Password cannot be empty."),n=!0),n){f.show(),m.hide(),s.show();return}o(ni,{email:b.value,password:_.value},(i,c)=>{i?(f.show(),m.hide(),i==="Login failed"&&(s.setText("Login failed, please double check your email and password."),s.show())):window.location.reload()})},$n=()=>{a.hide(),r.hide(),m.show();let t=mt.value,e=ht.value,n=ft.value,i=!1;if(t===""?(a.setText("Name cannot be empty."),i=!0):e===""?(a.setText("Email cannot be empty."),i=!0):e.indexOf("@")===-1?(a.setText("Email is not valid."),i=!0):n===""&&(a.setText("Password cannot be empty."),i=!0),i){a.show(),r.show(),m.hide();return}o(ii,{name:t,email:e,password:n},(c,d)=>{r.show(),m.hide(),c?(c==="Invalid email address"?a.setText("The email address you entered was invalid."):c==="Already signed up"&&a.setText("Seems like you already have an account! Please log in."),a.show()):window.location.reload()})},Qn=()=>{R.hide(),re.hide();let t=on.value;if(t){if(t.indexOf("@")===-1){R.setText('Email address is not valid and must contain "@".'),R.show();return}}else{R.setText("Please fill out your email."),R.show();return}o(oi,{email:t,captcha:"captcha"},(e,n)=>{if(m.show(),e){R.setText("Something went wrong, please try again."),R.show(),m.hide();return}re.setText(`We have sent an email to ${t} to reset your password.`),re.show(),ln.hide(),rn.hide(),m.hide()})},Vn=()=>{ce.hide(),B.hide();let t=an.value;if(!t){B.setText("Please set a new password."),B.show();return}o(li,{password:t,id:Je,key:Ze},(e,n)=>{if(e){B.setText("Something went wrong, please try again."),B.show();return}ce.innerHTML='Your password has been successfully set. <a href="/account">Log in</a>',ce.show()})},zn=()=>{o(si,{},(t,e)=>{t||window.location.reload()})},G=t=>{o(mi,{type:p,variation:w,renew:U},(e,n)=>{e?(l.setText(e),l.show()):t&&t(n.secret)})},ge=()=>{F&&(w=(parseInt(w)+C.seats).toString()),l.hide(),o(se,{type:p,variation:w},(t,e)=>{t?(l.setText(t),l.show()):ee(e,fish(".modal-container.mod-commercial-license"))})};Gn(),Kn(),Ut.addEventListener("click",()=>{zn()});let ve=()=>{let t=T.getText();ct(t),T.setText("Copied!"),T.addClass("is-copied"),T.removeEventListener("click",ve),setTimeout(()=>{T.removeClass("is-copied"),T.setText(t),T.addEventListener("click",ve)},500)};T.addEventListener("click",ve),N.addEventListener("input",()=>{if(p="business",N.value===""||F&&parseInt(N.value)===0)return;w=parseInt(N.value).toString(),ge()}),ae.forEach(t=>{t.addEventListener("click",()=>{ae.forEach(e=>e.removeClass("is-selected")),t.addClass("is-selected"),p="catalyst",w=t.getAttribute("data-tier"),!!["insider","supporter","vip"].contains(w)&&o(se,{type:p,variation:w},(e,n)=>{e?(l.setText(e),l.show()):(ee(n,fish(".modal-container.mod-personal-license")),Ke.show(),h.mount(".modal-container.mod-personal-license .card-element"))})})}),Vt.forEach(t=>{t.addEventListener("click",L)}),tn.addEventListener("click",()=>{location.hash="#mode=signup",location.reload()}),nn.addEventListener("click",()=>{location.hash="",location.reload()}),sn.addEventListener("click",()=>{location.hash="#mode=forgotpass",location.reload()}),f.find("form").addEventListener("submit",t=>{t.preventDefault(),Wn()}),r.find("form").addEventListener("submit",t=>{t.preventDefault(),$n()}),Xe.find("form").addEventListener("submit",t=>{t.preventDefault(),Qn()}),Ge.find("form").addEventListener("submit",t=>{t.preventDefault(),Vn()});let te=()=>{let t=de.filter(i=>i.hasClass("is-selected"));if(t.length===0)return;let e=t[0].getAttribute("data-renew"),n=We.value.toString();p="publish",w=n,U=e,l.hide(),o(se,{type:"publish",renew:e,variation:n},(i,c)=>{i?(l.setText(i),l.show()):ee(c,fish(".modal-container.mod-choose-publish-plan"))})},tt=()=>{let t=ue.filter(n=>n.hasClass("is-selected"));if(t.length===0)return;let e=t[0].getAttribute("data-renew");p="sync",U=e,l.hide(),o(se,{type:"sync",renew:e},(n,i)=>{n?(l.setText(n),l.show()):ee(i,V)})};cn.addEventListener("click",()=>{Q.show(),h.mount(".modal-container.mod-choose-publish-plan .card-element"),l=fish(".modal-container.mod-choose-publish-plan .payment-error"),te()}),de.forEach(t=>{t.addEventListener("click",()=>{de.forEach(e=>e.removeClass("is-selected")),t.addClass("is-selected"),te()})}),We.addEventListener("change",()=>{te()}),mn.addEventListener("submit",function(t){t.preventDefault(),fishAll(".payment-error").forEach(e=>e.hide()),D(!0),G(e=>X(h,e))}),hn.forEach(t=>t.addEventListener("click",()=>{fn.show()})),pn.forEach(t=>t.addEventListener("click",()=>{yn.show()})),ke.addEventListener("click",()=>{o(M,{type:"publish",renew:"monthly"},()=>{window.location.reload()})}),_e.addEventListener("click",()=>{o(M,{type:"publish",renew:"yearly"},()=>{window.location.reload()})}),Fe.addEventListener("click",()=>{o(M,{type:"publish",renew:""},()=>{window.location.reload()})}),Bt.addEventListener("click",()=>{Q.show(),h.mount(".modal-container.mod-choose-publish-plan .card-element"),l=fish(".modal-container.mod-choose-publish-plan .payment-error"),te()}),oe.addEventListener("click",()=>{dn.show()}),qt.addEventListener("click",()=>{let t=parseInt(Ue.value);o(yi,{sites:t},()=>{window.location.reload()})}),Yt.forEach(t=>t.addEventListener("click",()=>{o(Ei,{},(e,n)=>{n.info?Ae.setText(`You're currently using a ${n.info}.`):Ae.setText("You currently do not have any payment methods on file."),un.show()})})),jt.forEach(t=>t.addEventListener("click",()=>{De.show(),l=De.find(".payment-error"),h.mount(".modal-container.mod-change-payment-method .card-element")})),Ot.addEventListener("submit",t=>{t.preventDefault(),we.createPaymentMethod({type:"card",card:h}).then(e=>{e.paymentMethod&&e.paymentMethod.id?o(wi,{payment_method_id:e.paymentMethod.id},()=>{window.location.reload()}):(l.setText("Could not update your payment method."),l.show())})}),En.addEventListener("click",()=>{$e.show(),l=$e.find(".payment-error"),h.mount(".modal-container.mod-donation .card-element")}),wn.addEventListener("submit",t=>{t.preventDefault(),fishAll(".payment-error").forEach(e=>e.hide()),D(!0),G(e=>X(h,e))}),Qe.addEventListener("change",()=>{p="donation",w=(Qe.valueAsNumber*100).toString()}),bn.addEventListener("click",()=>{V.show(),h.mount(".modal-container.mod-choose-sync-plan .card-element"),l=fish(".modal-container.mod-choose-sync-plan .payment-error"),tt()}),ue.forEach(t=>{t.addEventListener("click",()=>{ue.forEach(e=>e.removeClass("is-selected")),t.addClass("is-selected"),tt()})}),Tn.addEventListener("submit",function(t){t.preventDefault(),fishAll(".payment-error").forEach(e=>e.hide()),D(!0),G(e=>X(h,e))}),me.addEventListener("click",()=>{o(M,{type:"sync",renew:"monthly"},()=>{window.location.reload()})}),he.addEventListener("click",()=>{o(M,{type:"sync",renew:"yearly"},()=>{window.location.reload()})}),fe.addEventListener("click",()=>{o(M,{type:"sync",renew:""},()=>{window.location.reload()})}),z.addEventListener("click",()=>{o(M,{type:"business",renew:""},()=>{window.location.reload()})}),ye.addEventListener("click",()=>{o(M,{type:"business",renew:"yearly"},()=>{window.location.reload()})}),Mn.forEach(t=>{t.addEventListener("click",()=>{t.hasClass("is-enabled")?t.removeClass("is-enabled"):t.addClass("is-enabled")})}),Sn.forEach(t=>t.addEventListener("click",()=>{let e="823279137640415263",n=location.protocol+"//"+location.host+location.pathname;t.addClass("mod-disabled"),location.href=`https://discord.com/api/oauth2/authorize?client_id=${e}&redirect_uri=${encodeURIComponent(n)}&response_type=code&scope=identify`})),In.forEach(t=>t.addEventListener("click",()=>{t.addClass("mod-disabled"),o(vi,{},(e,n)=>{e?(_n.setText(e),Dn.show()):An.show(),t.removeClass("mod-disabled")})})),Et.addEventListener("click",()=>{wt.show()}),bt.addEventListener("click",()=>{S.hide();let t=gt.value,e=vt.value;if(t===""){S.setText("New email cannot be empty."),S.show();return}if(e===""){S.setText("Password cannot be empty."),S.show();return}o(ri,{password:e,email:t},(n,i)=>{if(n){S.setText(n),S.show();return}else L(),v=!0,O.show()})}),Tt.addEventListener("click",()=>{Lt.show()}),Ct.addEventListener("click",()=>{j.hide();let t=xt.value;if(t===""){j.setText("New name cannot be empty."),j.show();return}o(ai,{name:t},(e,n)=>{if(e){j.setText(e),j.show();return}else L(),v=!0,O.show()})}),Mt.addEventListener("click",()=>{St.show()}),Rt.addEventListener("click",()=>{I.hide();let t=It.value,e=Pt.value;if(t===""){I.setText("Current password cannot be empty."),I.show();return}if(t===""){I.setText("New password cannot be empty."),I.show();return}o(ci,{old_password:t,new_password:e},(n,i)=>{if(n){I.setText(n),I.show();return}else L(),v=!0,O.show()})}),At.addEventListener("click",()=>{Dt.show()}),Nt.addEventListener("click",()=>{P.hide();let t=_t.value,e=kt.value;if(t===""){P.setText("Please enter your email to confirm account deletion."),P.show();return}if(e===""){P.setText("Please enter your password to confirm account deletion."),P.show();return}o(di,{email:t,password:e},(n,i)=>{if(n){P.setText(n),P.show();return}else L(),v=!0,O.show()})}),Hn.addEventListener("click",()=>{le.addClass("is-updating"),l=fish(".modal-container.mod-commercial-license .payment-error"),le.show(),h.mount(".modal-container.mod-commercial-license .card-element"),p="business",w=parseInt(N.value).toString(),F=!0,$t.setText("Add seats"),ge()}),Yn.addEventListener("click",()=>{jn.show()}),Bn.addEventListener("click",()=>{A.hide();let t=On.valueAsNumber,e=C.seats;if(t===0){A.setText("The number of seats to remove cannot be 0."),A.show();return}let n=e-t;if(n<0){let i=e===1?"1 seat":e+" seats";A.setText("You currently have "+i+" and cannot remove more seats than that."),A.show();return}o(pi,{seats:n},(i,c)=>{if(i){A.setText(i),A.show();return}else L(),v=!0,O.show()})});let nt="",it=fish(".modal-container.mod-invoice-list");fish(".js-view-invoices").addEventListener("click",()=>{m.show(),E.hide(),o(bi,{},(t,e)=>{m.hide(),E.show(),it.show();let n=it.find(".invoice-list");n.empty();for(let i of e)n.createDiv({cls:"invoice-item setting-item"},c=>{c.createDiv({cls:"setting-item-info"},d=>{d.createDiv({text:i.description,cls:"setting-item-name"}),d.createDiv({text:new Date(i.created*1e3).toLocaleString(),cls:"setting-item-description"})}),c.createDiv({cls:"setting-item-control mod-vertical"},d=>{d.createEl("button",{cls:"mod-cta",text:"View"},x=>{x.addEventListener("click",()=>{let y=(i.amount/100).toFixed(2),H=(i.refunded/100).toFixed(2),K=((i.amount-i.refunded)/100).toFixed(2),be=i.refunded!==0,ne=localStorage.getItem("billing-info");fish(".invoice-date").setText(new Date(parseInt(i.created)*1e3).toLocaleString()),fish(".invoice-number-title").setText(i.receipt_number||i.id),fish(".invoice-number").setText(i.receipt_number||i.id),fish(".invoice-description").setText(i.description),fish(".invoice-amount").setText(y),be?(fish(".invoice-box .item.mod-refund").show(),fish(".invoice-refund-amount").setText(H)):fish(".invoice-box .item.mod-refund").hide(),fish(".invoice-total").setText(K),ne&&fish(".billing-info").setText(ne),fish(".billing-info").addEventListener("input",()=>{let Te=fish(".billing-info").getText();localStorage.setItem("billing-info",Te)}),fish(".modal-container.mod-invoice-detail").show()})}),i.refundable&&d.createEl("a",{text:"Get refund"},x=>{x.addEventListener("click",()=>{nt=i.id,fish(".modal-container.mod-confirm-refund").show()})})})})})}),fish(".js-confirm-refund").addEventListener("click",()=>{fish(".modal-container.mod-invoice-list").hide(),fish(".modal-container.mod-confirm-refund").hide(),m.show(),E.hide(),o(Ti,{charge:nt},(t,e)=>{m.hide(),E.show(),t?(fish(".refund-failed-reason").setText(t),fish(".modal-container.mod-refund-failed").show()):(v=!0,fish(".modal-container.mod-refund-success").show())})})})},500);})();
