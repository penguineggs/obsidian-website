(()=>{function at(f){if(!navigator.clipboard||!navigator.permissions){let s=document.createElement("textarea");s.value=f,s.style.top="0",s.style.left="0",s.style.position="fixed",document.body.appendChild(s);try{s.focus(),s.select(),document.execCommand("copy")}catch(r){}document.body.removeChild(s);return}navigator.clipboard.writeText(f)}var vi=window.requestIdleCallback;var bi=/bot|crawl|spider/i.test(navigator.userAgent);function xe(f,s,r){return"https://raw.githubusercontent.com/"+f+"/"+(r||"HEAD")+"/"+s}function o(f,s,r){ajax({method:"POST",url:f,data:s,success:a=>{if(a=JSON.parse(a),a.error){r(a.error);return}r(null,a)},error:a=>{if(a.error){r(a.error);return}r(a)}})}var Mi=xe("obsidianmd/obsidian-releases","community-plugins.json");var Ci=xe("obsidianmd/obsidian-releases","community-css-themes.json");var k=class{static encodeUrlQuery(s){if(!s)return"";let r=[];for(let a in s)s.hasOwnProperty(a)&&s[a]&&(s[a]===!0?r.push(encodeURIComponent(a)):r.push(encodeURIComponent(a)+"="+encodeURIComponent(s[a])));return r.join("&")}static decodeUrlQuery(s){let r={};if(!s||s.trim()==="")return r;let a=s.split("&");for(let y=0;y<a.length;y++){let b=a[y].split("=");if(b.length>=1&&b[0]){let _=decodeURIComponent(b[0]);b.length===2?r[_]=decodeURIComponent(b[1]):r[_]=""}}return r}static decodeUrl(s){s||(s="");let r=s.split("#"),a=r.length>1?r[1]:"",y=r[0].split("?"),b=y.length>1?y[1]:"";return{path:y[0],query:k.decodeUrlQuery(b),hash:k.decodeUrlQuery(a)}}};var u="https://api.obsidian.md",Vn=u+"/user/info",zn=u+"/user/signin",Jn=u+"/user/signup",Zn=u+"/user/signout",ei=u+"/user/forgetpass",ti=u+"/user/resetpass",ni=u+"/user/changename",ii=u+"/user/changeemail",si=u+"/user/changepass",oi=u+"/user/deleteaccount",li=u+"/subscription/list",ai=u+"/subscription/stripe/start",ri=u+"/subscription/stripe/end",ie=u+"/subscription/price",ci=u+"/subscription/business/rename",di=u+"/subscription/business/reduce",C=u+"/subscription/renew",ui=u+"/subscription/publish/reduce",mi=u+"/subscription/paymentmethod",hi=u+"/subscription/stripe/paymentmethod",fi=u+"/subscription/role/discord",pi=u+"/subscription/role/forum",Ei=u+"/subscription/invoice/list",yi=u+"/subscription/invoice/refund",wi="pk_live_vqeOYADfYPpqKDT5FtAqCNBP00a9WEhYa6";function Me(){history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):location.hash=""}function $(f){let s=(f/100).toFixed(2).toString().toString().split(".");return s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),s.join(".")}var W=location.hash;W&&W.length>1&&(W=W.substr(1));var Q=location.search;Q&&Q.length>1&&(Q=Q.substr(1));window.setTimeout(()=>{ready(()=>{let f=fish(".login-form"),s=fish(".login-form .message.mod-error"),r=fish(".signup-form"),a=fish(".signup-form .message.mod-error"),y=fish(".welcome"),b=fish("#labeled-input-email"),_=fish("#labeled-input-password"),rt=fish(".signup-name"),ct=fish(".obsidian-signup-email"),dt=fish(".signup-password"),ut=fish(".welcome-name"),mt=fish(".welcome-email"),ht=fish(".js-change-email"),ft=fish(".modal-container.mod-change-email"),pt=fish(".change-email-new-email"),Et=fish(".change-email-password"),yt=fish(".js-confirm-change-email"),S=fish(".modal-container.mod-change-email .message.mod-error"),wt=fish(".js-change-name"),gt=fish(".modal-container.mod-change-name"),vt=fish(".change-name-new-name"),bt=fish(".js-confirm-change-name"),Y=fish(".modal-container.mod-change-name .message.mod-error"),Tt=fish(".js-change-password"),Lt=fish(".modal-container.mod-change-password"),xt=fish(".change-password-old-password"),Mt=fish(".change-password-new-password"),Ct=fish(".js-confirm-change-password"),I=fish(".modal-container.mod-change-password .message.mod-error"),St=fish(".js-delete-account"),It=fish(".modal-container.mod-delete-account"),Pt=fish(".delete-account-password"),Rt=fish(".delete-account-email"),At=fish(".js-confirm-delete-account"),P=fish(".modal-container.mod-delete-account .message.mod-error"),j=fish(".modal-container.mod-change-info-success"),Dt=fish(".js-logout"),Ce=fish(".card.mod-publish"),Se=fish(".card.mod-sync"),Ie=fish(".publish-site-num"),Pe=fish(".publish-renew-site-num"),kt=fishAll(".publish-renewal-time"),_t=fish(".publish-renew-info-renewing"),Re=fish(".publish-renew-info-not-renewing"),Nt=fishAll(".js-view-payment-info"),Ut=fishAll(".js-open-change-payment"),Ae=fish(".current-card-info"),De=fish(".modal-container.mod-change-payment-method"),Ft=fish(".modal-container.mod-change-payment-method .payment-form"),Ht=fish(".js-change-number-of-publish-sites"),se=fish(".js-reduce-number-of-publish-sites"),ke=fish(".js-change-publish-to-monthly"),_e=fish(".js-change-publish-to-yearly"),Ne=fish(".setting-item-description.mod-publish-frequency"),Ue=fish(".publish-reduce-sites-num"),Yt=fish(".js-update-reduce-sites"),Fe=fish(".js-stop-publish-auto-renewal"),jt=fish(".commercial-license-pitch"),Bt=fish(".existing-commercial-license"),He=fish(".business-name-input"),T=fish(".commercial-license-key"),Ot=fish(".commercial-license-company-name"),qt=fishAll(".commercial-license-seat-number"),Ye=fish(".card.mod-commercial-license"),oe=fish(".modal-container.mod-commercial-license"),Xt=fish(".modal-container.mod-commercial-license .modal-title"),je=fish(".modal-container.mod-personal-license"),Gt=fish(".catalyst-tier"),Be=fish(".catalyst-upgrade-button"),Kt=fishAll(".js-close-modal, .modal-close-button, .modal-bg"),Oe=fish(".card.mod-catalyst"),qe=fish('.card[data-tier="insider"]'),$t=fish('.card[data-tier="supporter"]'),le=fishAll(".modal-container.mod-personal-license .card"),Wt=fish(".modal-container.mod-personal-license .payment-form"),Qt=fish(".modal-container.mod-commercial-license .payment-form"),Vt=fish(".commercial-license-auto-renewal"),m=fish(".loader-cube"),zt=fish(".js-go-to-signup"),Jt=fish(".js-go-to-login"),Zt=fish(".js-go-to-forgot-pass"),Xe=fish(".forgot-pass-form"),ae=fish(".forgot-pass-form .message.mod-success"),R=fish(".forgot-pass-form .message.mod-error"),en=fish(".forgot-pass-email"),Ge=fish(".reset-pass-form"),tn=fish(".forgot-pass-email-container"),nn=fish(".reset-pass-password"),re=fish(".reset-pass-form .message.mod-success"),B=fish(".reset-pass-form .message.mod-error"),sn=fish(".js-request-forgot"),Ke=fish(".modal-container.mod-personal-license .payment-container"),N=fish(".commercial-license-seat"),l=null,on=fish(".js-upgrade-publish"),V=fish(".modal-container.mod-choose-publish-plan"),ln=fish(".modal-container.mod-publish-reduce-sites"),an=fish(".modal-container.mod-view-payment-method"),ce=V.findAll(".card"),$e=V.find(".publish-sites-num"),rn=fish(".modal-container.mod-choose-publish-plan .payment-form"),cn=fishAll(".wechat-pay-image"),dn=fish(".modal-container.mod-wechat-pay"),un=fishAll(".paypal-pay-image"),mn=fish(".modal-container.mod-paypal-pay"),hn=fish(".js-open-unlimited"),We=fish(".modal-container.mod-donation"),fn=fish(".modal-container.mod-donation .payment-form"),Qe=fish(".donation-amount-input"),pn=fish(".donation-amount"),En=fishAll(".modal-container"),yn=fish(".js-upgrade-sync"),z=fish(".modal-container.mod-choose-sync-plan"),de=z.findAll(".card"),wn=z.find(".payment-form"),ue=fish(".js-change-sync-to-monthly"),me=fish(".js-change-sync-to-yearly"),he=fish(".js-stop-sync-auto-renewal"),gn=fishAll(".sync-renewal-time"),Ve=fish(".sync-renew-info-renewing"),fe=fish(".sync-renew-info-not-renewing"),ze=fish(".setting-item-description.mod-sync-frequency"),vn=fishAll(".commercial-renewal-time"),pe=fish(".js-resume-commercial-auto-renewal"),J=fish(".js-stop-commercial-auto-renewal"),Ee=fish(".commercial-renew-info-renewing"),Z=fish(".commercial-renew-info-not-renewing"),bn=fishAll(".commercial-license-expiry-time"),Tn=fishAll(".checkbox-container"),Ln=fishAll(".claim-discord-badge-button"),xn=fishAll(".claim-forum-badge-button"),Mn=fish(".modal-container.mod-discord-success"),Cn=fish(".modal-container.mod-discord-failure"),Sn=fish(".modal-container.mod-forum-success"),In=fish(".modal-container.mod-forum-failure"),Pn=fish(".modal-container.mod-discord-failure .message.mod-error"),Rn=fish(".modal-container.mod-forum-failure .message.mod-error"),An=fish(".modal-container.mod-catalyst-payment-success"),Dn=fish(".modal-container.mod-publish-payment-success"),kn=fish(".modal-container.mod-sync-payment-success"),_n=fish(".js-commercial-license-change-seat"),Nn=fish(".js-commercial-license-reduce-seat"),Un=fish(".modal-container.mod-commercial-license-reduce-seats"),Fn=fish(".commercial-license-reduce-seat-input"),Hn=fish(".js-update-reduce-seats"),A=fish(".modal-container.mod-commercial-license-reduce-seats .payment-error"),Yn={base:{color:"#dcddde",iconColor:"#dcddde",fontFamily:"Inter, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#888888"}},invalid:{fontFamily:"Inter, sans-serif",color:"#fa755a",iconColor:"#fa755a"}},O="",p=null,w=null,U=null,ee=!1,Je=null,Ze=null,v=!1,M=null,F=!1,ye=window.Stripe(wi),h=ye.elements().create("card",{style:Yn}),L=()=>{if(v){window.location.reload();return}h.unmount(),Ke.hide(),En.forEach(e=>e.hide()),le.forEach(e=>e.removeClass("is-selected")),v=!1},g=k.decodeUrlQuery(W);if(g.mode&&g.mode==="signup")Me(),m.hide(),r.show(),ee=!0;else if(g.mode&&g.mode==="forgotpass")Me(),m.hide(),Xe.show(),ee=!0;else if(g.hasOwnProperty("forgetpw")&&g.id&&g.key)Me(),Je=g.id,Ze=g.key,m.hide(),Ge.show(),ee=!0;else if(g.stripe&&g.stripe==="complete"){let e=g.session}let et=k.decodeUrlQuery(Q);et.code&&o(fi,{code:et.code},(e,t)=>{e?(Pn.setText(e),Cn.show()):Mn.show(),window.history.replaceState(null,null,window.location.pathname)}),Wt.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),D(!0),X(t=>q(h,t))}),Qt.addEventListener("submit",function(e){if(e.preventDefault(),fishAll(".payment-error").forEach(n=>n.hide()),!He.value&&!F){l.setText("Please enter a business name."),l.show();return}F?U=M.renew:Vt.hasClass("is-enabled")?U="yearly":U="",D(!0),X(n=>q(h,n))});let q=function(e,t){l.hide(),ye.confirmCardPayment(t,{payment_method:{card:e}}).then(function(n){n.error?(D(!1),l.setText(n.error.message),l.show()):jn(n.paymentIntent.id)})},te=function(e,t){let n=t.find(".payment-line.mod-subtotal"),i=t.find(".payment-line.mod-subtotal .payment-desc"),c=t.find(".payment-line.mod-subtotal .payment-amount"),d=t.find(".payment-line.mod-discount"),x=t.find(".payment-line.mod-discount .payment-desc"),E=t.find(".payment-line.mod-discount .payment-amount"),H=t.find(".payment-line.mod-tax"),G=t.find(".payment-line.mod-tax .payment-desc"),ve=t.find(".payment-line.mod-tax .payment-amount"),K=t.find(".payment-line.mod-total .payment-desc"),be=t.find(".payment-line.mod-total .payment-amount"),{subtotal:st,desc:ot,tax:Te,taxDesc:Wn,discount:Le,discountDesc:Qn,total:lt}=e;Le===0?d.hide():(d.show(),E.setText($(Le)),x.setText(Qn||"")),Te===0?H.hide():(H.show(),ve.setText($(Te)),G.setText(Wn||"")),st===lt&&Le===0&&Te===0?(n.hide(),K.setText(ot)):(n.show(),c.setText($(st)),i.setText(ot||""),K.setText("Total")),be.setText($(lt))},jn=function(e){o(ri,{intent_id:e},(t,n)=>{if(D(!1),t)l.setText(t),l.show();else{let i=He.value;p==="business"&&!F?o(ci,{company:i},(c,d)=>{c?(l.setText(c),l.show()):window.location.reload()}):p==="catalyst"?(L(),v=!0,An.show()):p==="publish"?(L(),v=!0,Dn.show()):p==="sync"?(L(),v=!0,kn.show()):window.location.reload()}})},D=function(e){e?(fishAll("button.submit").forEach(t=>t.addClass("mod-disabled")),fishAll(".spinner").forEach(t=>t.removeClass("hidden")),fishAll(".button-text").forEach(t=>t.addClass("hidden"))):(fishAll("button.submit").forEach(t=>t.removeClass("mod-disabled")),fishAll(".spinner").forEach(t=>t.addClass("hidden")),fishAll(".button-text").forEach(t=>t.removeClass("hidden")))},Bn=()=>{o(Vn,{},(e,t)=>{e?ee||(m.hide(),f.show()):(ut.setText(t.name),mt.setText(t.email),t.donation&&pn.setText($(t.donation)),r.hide(),m.hide(),y.show(),t.license&&(O=t.license),O?(Oe.addClass("is-active"),Gt.setText(t.license),O!=="vip"&&(Be.addEventListener("click",()=>{l=fish(".modal-container.mod-personal-license .payment-error"),je.show()}),Be.show(),O==="supporter"?(qe.hide(),$t.hide()):O==="insider"&&qe.hide())):Oe.addEventListener("click",()=>{l=fish(".modal-container.mod-personal-license .payment-error"),je.show()}))})},On=()=>{o(li,{},(e,t)=>{if(!e){if(t.business&&t.business!==null&&t.business.expiry>=Date.now()){M=t.business,T.setText(M.key),Ot.setText(M.company);let n=M.seats,i=n===1?"1 seat":n+" seats";qt.forEach(c=>c.setText(i)),bn.forEach(c=>c.setText(new Date(M.expiry).toLocaleDateString())),jt.hide(),Bt.show()}else Ye.addEventListener("click",()=>{p="business",w=parseInt(N.value).toString(),l=fish(".modal-container.mod-commercial-license .payment-error"),oe.show(),h.mount(".modal-container.mod-commercial-license .card-element"),we()});if(t.publish){let{sites:n,renew:i,renew_sites:c,expiry_ts:d,earlybird:x}=t.publish;if(d>=Date.now()){if(Ce.addClass("is-active"),n===1?Ie.setText("1 site"):Ie.setText(`${n} sites`),c===1?(Pe.setText("1 site"),se.hide()):(Pe.setText(`${c} sites`),se.show()),d){let H=new Date(d);kt.forEach(G=>G.setText(`on ${H.toLocaleDateString()}`))}Re.hide();let E=document.createDocumentFragment();i==="yearly"?(_e.hide(),E.createSpan({text:"You're currently on a "}),E.createSpan({cls:"u-pop",text:"yearly"}),E.createSpan({text:" plan."})):i==="monthly"?(ke.hide(),E.createSpan({text:"You're currently on a "}),E.createSpan({cls:"u-pop",text:"monthly"}),E.createSpan({text:" plan."})):i===""&&(Fe.hide(),Re.show(),_t.hide(),E.createSpan({text:"You're not currently being renewed."})),Ne.empty(),Ne.appendChild(E),Ue.value=n}x===!0&&(fish(".publish-yearly-price-per-month").setText("8"),fish(".publish-yearly-price-per-year").setText("96"),fish(".publish-monthly-price-per-month").setText("10"),fish(".publish-monthly-price-per-year").setText("120"),Ce.addClass("is-early-bird"))}if(t.sync){let{renew:n,expiry_ts:i,earlybird:c}=t.sync;if(i>=Date.now()){if(Se.addClass("is-active"),i){let x=new Date(i);gn.forEach(E=>E.setText(`on ${x.toLocaleDateString()}`))}fe.hide(),n==="yearly"||(n==="monthly"?ue.hide():n===""&&(he.hide(),fe.show(),Ve.hide()));let d=document.createDocumentFragment();n==="yearly"?(me.hide(),d.createSpan({text:"You're currently on a "}),d.createSpan({cls:"u-pop",text:"yearly"}),d.createSpan({text:" plan."})):n==="monthly"?(ue.hide(),d.createSpan({text:"You're currently on a "}),d.createSpan({cls:"u-pop",text:"monthly"}),d.createSpan({text:" plan."})):n===""&&(he.hide(),fe.show(),Ve.hide(),d.createSpan({text:"You're not currently being renewed."})),ze.empty(),ze.appendChild(d)}c===!0&&(fish(".sync-yearly-price-per-month").setText("4"),fish(".sync-yearly-price-per-year").setText("48"),fish(".sync-monthly-price-per-month").setText("5"),fish(".sync-monthly-price-per-year").setText("60"),Se.addClass("is-early-bird"))}if(t.business){let{renew:n,expiry:i}=t.business;if(i>=Date.now()){if(Ye.addClass("is-active"),i){let c=new Date(i);vn.forEach(d=>d.setText(`on ${c.toLocaleDateString()}`))}Z.hide(),n==="yearly"?(pe.hide(),J.show(),Z.hide(),Ee.show()):n===""&&(pe.show(),J.hide(),Z.show(),Ee.hide()),n==="yearly"?me.hide():n===""&&(J.hide(),Z.show(),Ee.hide())}}}})},qn=()=>{s.hide(),f.hide(),m.show();let e=b.value,t=_.value,n=!1;if(e===""?(s.setText("Email cannot be empty."),n=!0):e.indexOf("@")===-1?(s.setText("Email is not valid."),n=!0):t===""&&(s.setText("Password cannot be empty."),n=!0),n){f.show(),m.hide(),s.show();return}o(zn,{email:b.value,password:_.value},(i,c)=>{i?(f.show(),m.hide(),i==="Login failed"&&(s.setText("Login failed, please double check your email and password."),s.show())):window.location.reload()})},Xn=()=>{a.hide(),r.hide(),m.show();let e=rt.value,t=ct.value,n=dt.value,i=!1;if(e===""?(a.setText("Name cannot be empty."),i=!0):t===""?(a.setText("Email cannot be empty."),i=!0):t.indexOf("@")===-1?(a.setText("Email is not valid."),i=!0):n===""&&(a.setText("Password cannot be empty."),i=!0),i){a.show(),r.show(),m.hide();return}o(Jn,{name:e,email:t,password:n},(c,d)=>{r.show(),m.hide(),c?(c==="Invalid email address"?a.setText("The email address you entered was invalid."):c==="Already signed up"&&a.setText("Seems like you already have an account! Please log in."),a.show()):window.location.reload()})},Gn=()=>{R.hide(),ae.hide();let e=en.value;if(e){if(e.indexOf("@")===-1){R.setText('Email address is not valid and must contain "@".'),R.show();return}}else{R.setText("Please fill out your email."),R.show();return}o(ei,{email:e,captcha:"captcha"},(t,n)=>{if(m.show(),t){R.setText("Something went wrong, please try again."),R.show(),m.hide();return}ae.setText(`We have sent an email to ${e} to reset your password.`),ae.show(),tn.hide(),sn.hide(),m.hide()})},Kn=()=>{re.hide(),B.hide();let e=nn.value;if(!e){B.setText("Please set a new password."),B.show();return}o(ti,{password:e,id:Je,key:Ze},(t,n)=>{if(t){B.setText("Something went wrong, please try again."),B.show();return}re.innerHTML='Your password has been successfully set. <a href="/account">Log in</a>',re.show()})},$n=()=>{o(Zn,{},(e,t)=>{e||window.location.reload()})},X=e=>{o(ai,{type:p,variation:w,renew:U},(t,n)=>{t?(l.setText(t),l.show()):e&&e(n.secret)})},we=()=>{F&&(w=(parseInt(w)+M.seats).toString()),l.hide(),o(ie,{type:p,variation:w},(e,t)=>{e?(l.setText(e),l.show()):te(t,fish(".modal-container.mod-commercial-license"))})};Bn(),On(),Dt.addEventListener("click",()=>{$n()});let ge=()=>{let e=T.getText();at(e),T.setText("Copied!"),T.addClass("is-copied"),T.removeEventListener("click",ge),setTimeout(()=>{T.removeClass("is-copied"),T.setText(e),T.addEventListener("click",ge)},500)};T.addEventListener("click",ge),N.addEventListener("input",()=>{if(p="business",N.value===""||F&&parseInt(N.value)===0)return;w=parseInt(N.value).toString(),we()}),le.forEach(e=>{e.addEventListener("click",()=>{le.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),p="catalyst",w=e.getAttribute("data-tier"),!!["insider","supporter","vip"].contains(w)&&o(ie,{type:p,variation:w},(t,n)=>{t?(l.setText(t),l.show()):(te(n,fish(".modal-container.mod-personal-license")),Ke.show(),h.mount(".modal-container.mod-personal-license .card-element"))})})}),Kt.forEach(e=>{e.addEventListener("click",L)}),zt.addEventListener("click",()=>{location.hash="#mode=signup",location.reload()}),Jt.addEventListener("click",()=>{location.hash="",location.reload()}),Zt.addEventListener("click",()=>{location.hash="#mode=forgotpass",location.reload()}),f.find("form").addEventListener("submit",e=>{e.preventDefault(),qn()}),r.find("form").addEventListener("submit",e=>{e.preventDefault(),Xn()}),Xe.find("form").addEventListener("submit",e=>{e.preventDefault(),Gn()}),Ge.find("form").addEventListener("submit",e=>{e.preventDefault(),Kn()});let ne=()=>{let e=ce.filter(i=>i.hasClass("is-selected"));if(e.length===0)return;let t=e[0].getAttribute("data-renew"),n=$e.value.toString();p="publish",w=n,U=t,l.hide(),o(ie,{type:"publish",renew:t,variation:n},(i,c)=>{i?(l.setText(i),l.show()):te(c,fish(".modal-container.mod-choose-publish-plan"))})},tt=()=>{let e=de.filter(n=>n.hasClass("is-selected"));if(e.length===0)return;let t=e[0].getAttribute("data-renew");p="sync",U=t,l.hide(),o(ie,{type:"sync",renew:t},(n,i)=>{n?(l.setText(n),l.show()):te(i,z)})};on.addEventListener("click",()=>{V.show(),h.mount(".modal-container.mod-choose-publish-plan .card-element"),l=fish(".modal-container.mod-choose-publish-plan .payment-error"),ne()}),ce.forEach(e=>{e.addEventListener("click",()=>{ce.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),ne()})}),$e.addEventListener("change",()=>{ne()}),rn.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),D(!0),X(t=>q(h,t))}),cn.forEach(e=>e.addEventListener("click",()=>{dn.show()})),un.forEach(e=>e.addEventListener("click",()=>{mn.show()})),ke.addEventListener("click",()=>{o(C,{type:"publish",renew:"monthly"},()=>{window.location.reload()})}),_e.addEventListener("click",()=>{o(C,{type:"publish",renew:"yearly"},()=>{window.location.reload()})}),Fe.addEventListener("click",()=>{o(C,{type:"publish",renew:""},()=>{window.location.reload()})}),Ht.addEventListener("click",()=>{V.show(),h.mount(".modal-container.mod-choose-publish-plan .card-element"),l=fish(".modal-container.mod-choose-publish-plan .payment-error"),ne()}),se.addEventListener("click",()=>{ln.show()}),Yt.addEventListener("click",()=>{let e=parseInt(Ue.value);o(ui,{sites:e},()=>{window.location.reload()})}),Nt.forEach(e=>e.addEventListener("click",()=>{o(mi,{},(t,n)=>{n.info?Ae.setText(`You're currently using a ${n.info}.`):Ae.setText("You currently do not have any payment methods on file."),an.show()})})),Ut.forEach(e=>e.addEventListener("click",()=>{De.show(),l=De.find(".payment-error"),h.mount(".modal-container.mod-change-payment-method .card-element")})),Ft.addEventListener("submit",e=>{e.preventDefault(),ye.createPaymentMethod({type:"card",card:h}).then(t=>{t.paymentMethod&&t.paymentMethod.id?o(hi,{payment_method_id:t.paymentMethod.id},()=>{window.location.reload()}):(l.setText("Could not update your payment method."),l.show())})}),hn.addEventListener("click",()=>{We.show(),l=We.find(".payment-error"),h.mount(".modal-container.mod-donation .card-element")}),fn.addEventListener("submit",e=>{e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),D(!0),X(t=>q(h,t))}),Qe.addEventListener("change",()=>{p="donation",w=(Qe.valueAsNumber*100).toString()}),yn.addEventListener("click",()=>{z.show(),h.mount(".modal-container.mod-choose-sync-plan .card-element"),l=fish(".modal-container.mod-choose-sync-plan .payment-error"),tt()}),de.forEach(e=>{e.addEventListener("click",()=>{de.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),tt()})}),wn.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),D(!0),X(t=>q(h,t))}),ue.addEventListener("click",()=>{o(C,{type:"sync",renew:"monthly"},()=>{window.location.reload()})}),me.addEventListener("click",()=>{o(C,{type:"sync",renew:"yearly"},()=>{window.location.reload()})}),he.addEventListener("click",()=>{o(C,{type:"sync",renew:""},()=>{window.location.reload()})}),J.addEventListener("click",()=>{o(C,{type:"business",renew:""},()=>{window.location.reload()})}),pe.addEventListener("click",()=>{o(C,{type:"business",renew:"yearly"},()=>{window.location.reload()})}),Tn.forEach(e=>{e.addEventListener("click",()=>{e.hasClass("is-enabled")?e.removeClass("is-enabled"):e.addClass("is-enabled")})}),Ln.forEach(e=>e.addEventListener("click",()=>{let t="823279137640415263",n=location.protocol+"//"+location.host+location.pathname;e.addClass("mod-disabled"),location.href=`https://discord.com/api/oauth2/authorize?client_id=${t}&redirect_uri=${encodeURIComponent(n)}&response_type=code&scope=identify`})),xn.forEach(e=>e.addEventListener("click",()=>{e.addClass("mod-disabled"),o(pi,{},(t,n)=>{t?(Rn.setText(t),In.show()):Sn.show(),e.removeClass("mod-disabled")})})),ht.addEventListener("click",()=>{ft.show()}),yt.addEventListener("click",()=>{S.hide();let e=pt.value,t=Et.value;if(e===""){S.setText("New email cannot be empty."),S.show();return}if(t===""){S.setText("Password cannot be empty."),S.show();return}o(ii,{password:t,email:e},(n,i)=>{if(n){S.setText(n),S.show();return}else L(),v=!0,j.show()})}),wt.addEventListener("click",()=>{gt.show()}),bt.addEventListener("click",()=>{Y.hide();let e=vt.value;if(e===""){Y.setText("New name cannot be empty."),Y.show();return}o(ni,{name:e},(t,n)=>{if(t){Y.setText(t),Y.show();return}else L(),v=!0,j.show()})}),Tt.addEventListener("click",()=>{Lt.show()}),Ct.addEventListener("click",()=>{I.hide();let e=xt.value,t=Mt.value;if(e===""){I.setText("Current password cannot be empty."),I.show();return}if(e===""){I.setText("New password cannot be empty."),I.show();return}o(si,{old_password:e,new_password:t},(n,i)=>{if(n){I.setText(n),I.show();return}else L(),v=!0,j.show()})}),St.addEventListener("click",()=>{It.show()}),At.addEventListener("click",()=>{P.hide();let e=Rt.value,t=Pt.value;if(e===""){P.setText("Please enter your email to confirm account deletion."),P.show();return}if(t===""){P.setText("Please enter your password to confirm account deletion."),P.show();return}o(oi,{email:e,password:t},(n,i)=>{if(n){P.setText(n),P.show();return}else L(),v=!0,j.show()})}),_n.addEventListener("click",()=>{oe.addClass("is-updating"),l=fish(".modal-container.mod-commercial-license .payment-error"),oe.show(),h.mount(".modal-container.mod-commercial-license .card-element"),p="business",w=parseInt(N.value).toString(),F=!0,Xt.setText("Add seats"),we()}),Nn.addEventListener("click",()=>{Un.show()}),Hn.addEventListener("click",()=>{A.hide();let e=Fn.valueAsNumber,t=M.seats;if(e===0){A.setText("The number of seats to remove cannot be 0."),A.show();return}let n=t-e;if(n<0){let i=t===1?"1 seat":t+" seats";A.setText("You currently have "+i+" and cannot remove more seats than that."),A.show();return}o(di,{seats:n},(i,c)=>{if(i){A.setText(i),A.show();return}else L(),v=!0,j.show()})});let nt="",it=fish(".modal-container.mod-invoice-list");fish(".js-view-invoices").addEventListener("click",()=>{m.show(),y.hide(),o(Ei,{},(e,t)=>{m.hide(),y.show(),it.show();let n=it.find(".invoice-list");n.empty();for(let i of t)n.createDiv({cls:"invoice-item setting-item"},c=>{c.createDiv({cls:"setting-item-info"},d=>{d.createDiv({text:i.description,cls:"setting-item-name"}),d.createDiv({text:new Date(i.created*1e3).toLocaleString(),cls:"setting-item-description"})}),c.createDiv({cls:"setting-item-control mod-vertical"},d=>{d.createEl("button",{cls:"mod-cta",text:"View"},x=>{x.addEventListener("click",()=>{let E=(i.amount/100).toFixed(2),H=(i.refunded/100).toFixed(2),G=((i.amount-i.refunded)/100).toFixed(2),ve=i.refunded!==0,K=localStorage.getItem("billing-info");fish(".invoice-date").setText(new Date(parseInt(i.created)*1e3).toLocaleString()),fish(".invoice-number-title").setText(i.receipt_number||i.id),fish(".invoice-number").setText(i.receipt_number||i.id),fish(".invoice-description").setText(i.description),fish(".invoice-amount").setText(E),ve?(fish(".invoice-box .item.mod-refund").show(),fish(".invoice-refund-amount").setText(H)):fish(".invoice-box .item.mod-refund").hide(),fish(".invoice-total").setText(G),K&&fish(".billing-info").setText(K),fish(".billing-info").addEventListener("input",()=>{let be=fish(".billing-info").getText();localStorage.setItem("billing-info",be)}),fish(".modal-container.mod-invoice-detail").show()})}),i.refundable&&d.createEl("a",{text:"Get refund"},x=>{x.addEventListener("click",()=>{nt=i.id,fish(".modal-container.mod-confirm-refund").show()})})})})})}),fish(".js-confirm-refund").addEventListener("click",()=>{fish(".modal-container.mod-invoice-list").hide(),fish(".modal-container.mod-confirm-refund").hide(),m.show(),y.hide(),o(yi,{charge:nt},(e,t)=>{m.hide(),y.show(),e?(fish(".refund-failed-reason").setText(e),fish(".modal-container.mod-refund-failed").show()):(v=!0,fish(".modal-container.mod-refund-success").show())})})})},500);})();
