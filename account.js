(()=>{var $n=Object.defineProperty,Kn=Object.defineProperties;var Wn=Object.getOwnPropertyDescriptors;var Ze=Object.getOwnPropertySymbols;var zn=Object.prototype.hasOwnProperty,Qn=Object.prototype.propertyIsEnumerable;var et=(a,e,t)=>e in a?$n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,be=(a,e)=>{for(var t in e||(e={}))zn.call(e,t)&&et(a,t,e[t]);if(Ze)for(var t of Ze(e))Qn.call(e,t)&&et(a,t,e[t]);return a},tt=(a,e)=>Kn(a,Wn(e));var o=(a,e,t)=>new Promise((i,s)=>{var u=y=>{try{f(t.next(y))}catch(w){s(w)}},p=y=>{try{f(t.throw(y))}catch(w){s(w)}},f=y=>y.done?i(y.value):Promise.resolve(y.value).then(u,p);f((t=t.apply(a,e)).next())});function nt(a){if(!navigator.clipboard||!navigator.permissions){let e=document.createElement("textarea");e.value=a,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e);try{e.focus(),e.select(),document.execCommand("copy")}catch(t){}document.body.removeChild(e);return}navigator.clipboard.writeText(a)}var Si=window.requestIdleCallback;var Ai=/bot|crawl|spider/i.test(navigator.userAgent);var Jn=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){Jn={passive:!1}}}))}catch(a){}function Zn(a){return new Promise((e,t)=>{let i=document.createElement("script");i.type="text/javascript",i.src=a,i.addEventListener("load",()=>e(i)),i.addEventListener("error",s=>t(s)),document.body.appendChild(i)})}function ve(a,e){let t=!1,i=null;return{get loaded(){return t},get promise(){if(t)return Promise.resolve();if(!i){e&&e.before&&e.before();let s=Zn(a);s.catch(u=>{u.detach(),i=null}),i=s.then(()=>{t=!0,i=null,e&&e.after&&e.after()})}return i},then(s){return t?s():this.promise.then(s)}}}var it=new Map;for(let a of"a abbr acronym b bdi bdo big br button canvas cite code data del dfn em embed i iframe img input ins kbd label map mark meter noscript object outputpicture progress q ruby s samp select small span strong sub sup svg textarea time u tt var video wbr".split(" "))it.set(a,!0);for(let a of"address article aside blockquote details dialog dd div dl dt fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr li main nav ol p pre ul".split(" "))it.set(a,!1);function v(a){let e,t=!1;return()=>(t||(e=a(),t=!0),e)}var I=class{static encodeUrlQuery(e){if(!e)return"";let t=[];for(let i in e)e.hasOwnProperty(i)&&e[i]&&(e[i]===!0?t.push(encodeURIComponent(i)):t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i])));return t.join("&")}static decodeUrlQuery(e){let t={};if(!e||e.trim()==="")return t;let i=e.split("&");for(let s=0;s<i.length;s++){let u=i[s].split("=");if(u.length>=1&&u[0]){let p=decodeURIComponent(u[0]);u.length===2?t[p]=decodeURIComponent(u[1]):t[p]=""}}return t}static decodeUrl(e){e||(e="");let t=e.split("#"),i=t.length>1?t[1]:"",s=t[0].split("?"),u=s.length>1?s[1]:"";return{path:s[0],query:I.decodeUrlQuery(u),hash:I.decodeUrlQuery(i)}}};function at(a){let e=[];for(let t=0;t<a;t++)e.push((Math.random()*16|0).toString(16));return e.join("")}function Q(a,e,t){return"https://raw.githubusercontent.com/"+a+"/"+(t||"HEAD")+"/"+e}function c(a,e){return o(this,null,function*(){let t;try{t=yield ajaxPromise({method:"POST",url:a,data:e})}catch(i){throw i.error?i.error:i}if(t=JSON.parse(t),t.error)throw t.error;return t})}var Ui=Q("obsidianmd/obsidian-releases","community-plugins.json");var Oi=Q("obsidianmd/obsidian-releases","community-plugin-stats.json");var Yi=Q("obsidianmd/obsidian-releases","community-css-themes.json");var lt=location.host.startsWith("127.0.0.1")||location.host.startsWith("localhost"),d="https://api.obsidian.md";lt&&(d="http://127.0.0.1:3000");var ei=d+"/user/info",ti=d+"/user/signin",ni=d+"/user/signup",ii=d+"/user/signout",ai=d+"/user/forgetpass",si=d+"/user/resetpass",ri=d+"/user/changename",li=d+"/user/changeemail",oi=d+"/user/changepass",ci=d+"/user/deleteaccount",ui=d+"/subscription/list",st=d+"/subscription/pay",di=d+"/subscription/stripe/end",rt=d+"/subscription/price",hi=d+"/subscription/business/rename",mi=d+"/subscription/business/reduce",L=d+"/subscription/renew",pi=d+"/subscription/publish/reduce",fi=d+"/subscription/paymentmethod",yi=d+"/subscription/stripe/paymentmethod",Ei=d+"/subscription/role/discord",gi=d+"/subscription/role/forum",wi=d+"/subscription/invoice/list",bi=d+"/subscription/invoice/refund",vi=d+"/subscription/paypal/clientid",Ti=d+"/subscription/stripe/finish",xi=d+"/user/discount/apply",ot="pk_live_vqeOYADfYPpqKDT5FtAqCNBP00a9WEhYa6";lt&&(ot="pk_test_y7CBP7qLG6kSU9sdcHV5S2db0052OC4wR8");function Te(){history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):location.hash=""}function ee(a){let e=(a/100).toFixed(2).toString().toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}var Y=location.hash;Y&&Y.length>1&&(Y=Y.substr(1));var j=location.search;j&&j.length>1&&(j=j.substr(1));window.location.search&&window.history.replaceState(null,null,window.location.pathname);var Ci=ve("https://js.braintreegateway.com/web/3.85.2/js/client.min.js"),Di=ve("https://js.braintreegateway.com/web/3.85.2/js/paypal-checkout.min.js"),ct=v(()=>o(void 0,null,function*(){yield Promise.all([Ci,Di]);let a=yield c(vi,{}),e=window.braintree,t=yield e.client.create({authorization:a.clientid});return{braintree:e,braintreeClient:t}})),Li=v(()=>o(void 0,null,function*(){let{braintree:a,braintreeClient:e}=yield ct(),t=yield a.paypalCheckout.create({client:e});yield t.loadPayPalSDK({vault:!0,currency:"CAD",intent:"capture"});let i=window.paypal;return{paypalCheckout:t,paypal:i}})),Pi=v(()=>o(void 0,null,function*(){let{braintree:a,braintreeClient:e}=yield ct();return yield a.dataCollector.create({client:e})}));function ut(a){return o(this,null,function*(){let e="823279137640415263",t=location.protocol+"//"+location.host+location.pathname;a.addClass("mod-disabled"),location.href=`https://discord.com/api/oauth2/authorize?client_id=${e}&redirect_uri=${encodeURIComponent(t)}&response_type=code&scope=identify`})}function dt(a){return o(this,null,function*(){a.addClass("mod-disabled");try{yield c(gi,{}),new Ct().open()}catch(e){new Dt(e).open()}a.removeClass("mod-disabled")})}var ht=class{constructor(e){this.value=!1;(this.el=e.createEl("span","checkbox-container")).addEventListener("click",()=>this.setValue(!this.value))}setValue(e){this.value=e,this.el.toggleClass("is-enabled",this.value)}getValue(){return this.value}},P=class{constructor(){this.containerEl=createDiv("modal-container");let e=this.bgEl=this.containerEl.createDiv("modal-bg");this.modalEl=this.containerEl.createDiv("modal");let t=this.modalEl.createDiv("modal-close-button");this.titleEl=this.modalEl.createDiv("modal-title"),this.contentEl=this.modalEl.createDiv("modal-content"),this.buttonContainerEl=this.modalEl.createDiv("modal-button-container"),t.addEventListener("click",this.close.bind(this)),e.addEventListener("click",this.close.bind(this))}setTitle(e){return this.titleEl.setText(e),this}open(){document.body.appendChild(this.containerEl),this.onOpen()}close(){this.onClose(),this.containerEl.detach()}onOpen(){}onClose(){}},te=class extends P{constructor(){super();let e=this.contentEl.createDiv("message-container");this.errorEl=e.createDiv("payment-error message mod-error"),this.hideError()}showError(e){let{errorEl:t}=this;e instanceof XMLHttpRequest&&(e=e.statusText),t.setText(e.toString()),t.style.visibility=""}hideError(){let{errorEl:e}=this;e.style.visibility="hidden",e.setText("")}},k=class{constructor(e,t){let i=this.containerEl=e.createDiv("payment-line");this.descEl=i.createSpan({cls:"payment-desc",text:t}),i.appendText(": "),this.amountEl=i.createSpan("payment-amount"),i.appendText(" USD")}setValues(e,t,i){let{containerEl:s,amountEl:u,descEl:p}=this;s.toggle(t!==0),u.setText(t>=0?"$"+ee(t):"-$"+ee(-t)),String.isString(i)&&p.setText(i)}},mt=class{constructor(e){this.subtotal=new k(e,"Subtotal"),this.discount=new k(e,"Discount"),this.tax=new k(e,"Tax"),this.credit=new k(e,"Credit"),this.total=new k(e,"Total")}setValues(e){let{subtotal:t,desc:i,tax:s,taxDesc:u,discount:p,discountDesc:f,creditUsed:y,total:w}=e;this.discount.setValues(p!==0,-p,f),this.tax.setValues(s!==0,s,u),this.credit.setValues(y!==0,-y,"Credit"),t===w&&p===0&&s===0&&y===0?(this.subtotal.setValues(!1,0,"Subtotal"),this.total.setValues(!0,w,i)):(this.subtotal.setValues(!0,t,i),this.total.setValues(!0,w,"Total"))}},pt=class{constructor(e){let t=this.formEl=e.createEl("form","payment-form");this.cardEl=t.createEl("label").createDiv("card-element");let i=this.payEl=t.createEl("button","submit mod-cta");this.spinnerEl=i.createDiv("spinner hidden"),this.textEl=i.createSpan({cls:"button-text",text:"Pay"}),this.stripeBadgeEl=t.createEl("p","stripe-badge u-center-text"),this.stripeBadgeEl.createEl("img",{attr:{src:"images/stripe-badge.png",alt:"Powered by Stripe"}})}setUseCredit(e){this.stripeBadgeEl.toggle(!e),this.payEl.toggleClass("mod-no-card",e),this.payEl.setText(e?"Pay with credit":"Pay")}},X=class extends te{constructor(){super();let{contentEl:e}=this;this.createPayment(e);let t=this.paymentContainerEl=e.createDiv("payment-container"),i=this.summaryEl=t.createDiv("payment-summary");this.summary=new mt(i),this.stripeButton=new pt(t);let s=t.createEl("p","u-center-text");this.paypalButtonEl=s.createEl("span","paypal-button"),this.wechatButtonEl=s.createEl("img",{cls:"wechat-pay-button",attr:{src:"images/wechat-pay.png",alt:"Pay with Wechat Pay"}}),this.alipayButtonEl=s.createEl("img",{cls:"alipay-button",attr:{src:"images/alipay.png",alt:"Pay with Alipay"}}),this.oldPaypalButtonEl=s.createEl("img",{cls:"paypal-temp-button",attr:{src:"images/paypal-badge.svg",alt:"Pay with PayPal"}}),this.stripeButton.formEl.addEventListener("submit",this.onSubmit.bind(this)),this.wechatButtonEl.addEventListener("click",()=>this.pay("wechat")),this.alipayButtonEl.addEventListener("click",()=>this.pay("alipay")),this.oldPaypalButtonEl.addEventListener("click",()=>new Pt().open()),this.setLoading(!1)}createPayment(e){}onSubmit(e){e.preventDefault(),this.pay("card")}setPrices(e){let t=e.total===0;this.stripeButton.cardEl.toggle(!t),this.stripeButton.setUseCredit(t),this.summary.setValues(e)}onOpen(){super.onOpen(),Z().mount(this.stripeButton.cardEl)}onClose(){super.onClose(),Z().unmount()}updatePrice(){return o(this,null,function*(){this.hideError();try{let e=this.getPriceData(!1),t=yield c(rt,e);this.setPrices(t)}catch(e){this.showError(e)}})}pay(e){return o(this,null,function*(){this.hideError(),this.setLoading(!0);try{let t=this.getPriceData(!0),i=yield c(st,be({method:e},t));if(i.secret){let s;if(e==="card")s=yield q().confirmCardPayment(i.secret,{payment_method:{card:Z()}});else if(e==="wechat")s=yield q().confirmWechatPayPayment(i.secret,{payment_method_options:{wechat_pay:{client:"web"}}});else if(e==="alipay")s=yield q().confirmAlipayPayment(i.secret,{return_url:Ti});else throw"Please select payment method.";if(s.error)throw s.error.message;yield c(di,{intent_id:s.paymentIntent.id})}}catch(t){this.showError(t),this.setLoading(!1);return}this.setLoading(!1),this.afterPay()})}setLoading(e){this.stripeButton.payEl.toggleClass("mod-disabled",e),this.stripeButton.spinnerEl.toggleClass("hidden",!e),this.stripeButton.textEl.toggleClass("hidden",e)}setupPaypal(e){return o(this,null,function*(){})}},xe=class{constructor(e,t){this.value=t,this.cardEl=e.createDiv("card u-center-text",i=>{i.createDiv("card-title",s=>{s.style.textAlign="left",s.appendText(t==="yearly"?"Yearly":"Monthly"),this.promoEl=s.createSpan({cls:"flair mod-pop",text:""})}),i.createDiv("card-description",s=>{s.createDiv({},u=>{u.style.float="right",this.perMonthEl=u.createEl("b",{text:"$-"}),u.appendText(" USD / month")}),s.createDiv({},u=>{u.style.float="left",this.perYearEl=u.createEl("b",{text:"$-"}),u.appendText(" USD / year")})})}),this.promoEl.hide()}setValues(e,t){this.perMonthEl.setText("$"+e),this.perYearEl.setText("$"+e*12),this.promoEl.setText(t),this.promoEl.toggle(!!t)}},Ce=class extends X{onOpen(){super.onOpen(),this.setCard(this.yearlyCard),this.setupPaypal(!0)}createPayment(e){let t=e.createDiv("card-container mod-horizontal"),i=this.yearlyCard=new xe(t,"yearly"),s=this.monthlyCard=new xe(t,"monthly");this.cards=[i,s],i.cardEl.addEventListener("click",()=>this.setCard(i)),s.cardEl.addEventListener("click",()=>this.setCard(s))}setCard(e){this.selectedCard&&this.selectedCard.cardEl.removeClass("is-selected"),this.selectedCard=e,e&&(e.cardEl.addClass("is-selected"),this.updatePrice())}setSubscriptionPrices(e){this.yearlyCard.setValues(e.yearly,e.yearlyPromo),this.monthlyCard.setValues(e.monthly,e.monthlyPromo)}onSubmit(e){e.preventDefault(),this.pay("card")}},ft=class extends Ce{constructor(e){super();this.setTitle("Choose a plan"),this.setSubscriptionPrices(e)}getPriceData(){return{type:"sync",variation:"",renew:this.selectedCard.value}}afterPay(){this.close(),new gt().open()}},yt=class extends Ce{constructor(e){super();this.setTitle("Choose a plan"),this.setSubscriptionPrices(e)}createPayment(e){super.createPayment(e);let t=e.createEl("p");t.createEl("label",{cls:"input-label",text:"Number of sites"}),this.numSitesEl=t.createEl("input",{type:"number",attr:{placeholder:"Enter a number...",min:1,value:1}}),this.numSitesEl.addEventListener("change",this.updatePrice.bind(this))}getPriceData(){return{type:"publish",variation:this.numSitesEl.value,renew:this.selectedCard.value}}afterPay(){this.close(),new wt().open()}},Et=class extends X{constructor(){super();this.currentSeats=0;this.setTitle("Commercial license"),this.containerEl.addClass("mod-commercial-license")}createPayment(e){super.createPayment(e),this.businessNameContainerEl=e.createEl("p",{},t=>{t.createEl("label",{cls:"input-label",text:"Business name"}),this.businessNameEl=t.createEl("input",{type:"text",placeholder:"Name of your business..."})}),e.createEl("p",{},t=>{t.createEl("label",{cls:"input-label",text:"Seats"}),this.seatsEl=t.createEl("input",{type:"number",placeholder:"1",attr:{min:1,value:1}})}),this.autoRenewalContainerEl=e.createEl("p",{},t=>{t.createEl("label",{cls:"input-label",text:"Auto-renewal"}),this.autoRenewal=new ht(t)}),this.seatsEl.addEventListener("input",this.updatePrice.bind(this))}setStatus(e,t){return this.currentSeats=e,e===0?this.setTitle("Commercial license"):this.setTitle("Add seats"),this.businessNameContainerEl.toggle(e===0),this.autoRenewalContainerEl.toggle(e===0),this.autoRenewal.setValue(t),this}getPriceData(e){let{currentSeats:t}=this;if(e&&t===0&&!this.businessNameEl.value)throw"Please enter a business name.";let i=this.seatsEl.value;if(i==="")return null;let s=parseInt(i);if(isNaN(s)||s<=0)return null;let u=this.autoRenewal.getValue()?"yearly":"";return{type:"business",variation:(t+s).toString(),renew:u}}afterPay(){return o(this,null,function*(){let e=this.businessNameEl.value;if(e)try{yield c(hi,{company:e})}catch(t){this.showError(t);return}window.location.reload()})}onOpen(){super.onOpen(),this.updatePrice(),this.setupPaypal(!1)}},gt=class extends P{constructor(){super();this.setTitle("Successfully bought Obsidian Sync"),this.contentEl.append(jsx("p",null,"Thanks so much for supporting us by using Obsidian Sync!"),jsx("p",null,"To learn more about how to use the in-app plugin to sync your vaults,",jsx("a",{href:"https://help.obsidian.md/Obsidian+Sync/Introduction+to+Obsidian+Sync",target:"_blank"},"here's a guide"),".")),this.buttonContainerEl.createEl("button",{cls:"mod-cta",text:"Got it"}).addEventListener("click",this.close.bind(this))}onClose(){super.onClose(),window.location.reload()}},wt=class extends P{constructor(){super();this.setTitle("Successfully bought Obsidian Publish"),this.contentEl.append(jsx("p",null,"Thanks so much for supporting us by using Obsidian Publish!"),jsx("p",null,"To learn more about how to publish your notes",jsx("a",{href:"https://help.obsidian.md/Obsidian+Publish/Introduction+to+Obsidian+Publish",target:"_blank"},"here's a guide"),".")),this.buttonContainerEl.createEl("button",{cls:"mod-cta",text:"Got it"}).addEventListener("click",this.close.bind(this))}onClose(){super.onClose(),window.location.reload()}},J=class{constructor(e,t,i,s,u){this.value=t,this.cardEl=e.createDiv("card",p=>{p.createDiv({cls:"card-title",text:i}),p.createDiv("card-description").appendChild(s),p.createDiv("button-container u-center-text").createEl("button","mod-cta",f=>{f.createEl("b",{text:"$"+u}),f.appendText(" USD one-time")})})}},bt=class extends X{constructor(){super();this.currentCard=null;this.setTitle("Obsidian Catalyst"),this.containerEl.addClass("mod-personal-license"),this.paymentContainerEl.hide()}createPayment(e){e.createDiv("card-container mod-catalyst",t=>{let i=[this.insiderCard=new J(t,"insider","Insider",jsx("ul",null,jsx("li",null,"Early access to insider builds"),jsx("li",null,jsx("b",{className:"u-pop"},'"Insider"')," badge in the community")),25),this.supporterCard=new J(t,"supporter","Supporter",jsx("ul",null,jsx("li",null,"Early access to insider builds"),jsx("li",null,"Access to exclusive dev channel"),jsx("li",null,jsx("b",{className:"u-pop"},'"Supporter"')," badge in the community")),50),this.vipCard=new J(t,"vip","VIP",jsx("ul",null,jsx("li",null,"Early access to insider builds"),jsx("li",null,"Access to exclusive dev channel"),jsx("li",null,jsx("b",{className:"u-pop"},'"VIP"')," badge in the community")),100)];for(let s of i)s.cardEl.addEventListener("click",()=>o(this,null,function*(){this.setCard(s)}))}),this.upgradeEl=this.contentEl.appendChild(jsx("div",{className:"u-muted"},jsx("p",null,"Please select a tier to upgrade. When upgrading you only need to pay the difference."))),this.upgradeEl.hide()}onOpen(){super.onOpen(),this.setupPaypal(!1)}setCard(e){this.paymentContainerEl.show(),this.currentCard&&this.currentCard.cardEl.removeClass("is-selected"),this.currentCard=e,e&&(e.cardEl.addClass("is-selected"),this.updatePrice())}setTier(e){e==="supporter"?(this.insiderCard.cardEl.hide(),this.supporterCard.cardEl.hide()):e==="insider"&&this.insiderCard.cardEl.hide(),e&&this.upgradeEl.show()}getPriceData(){let{currentCard:e}=this;return e?{type:"catalyst",variation:e.value,renew:""}:null}afterPay(){this.close(),new vt().open()}},vt=class extends P{constructor(){super();this.setTitle("Successfully bought Catalyst"),this.contentEl.append(jsx("p",null,"Thanks so much for supporting us by upgrading to Catalyst!"),jsx("p",null,"To get insider builds, ",jsx("a",{href:"https://help.obsidian.md/Insider+builds",target:"_blank"},"here's a guide"),"."),jsx("p",null,"To claim your community badges:")),this.buttonContainerEl.createEl("button",{cls:"mod-cta",text:"Get Discord badge"},e=>{e.addEventListener("click",()=>ut(e))}),this.buttonContainerEl.createEl("button",{cls:"mod-cta",text:"Get forum badge"},e=>{e.addEventListener("click",()=>dt(e))})}onClose(){super.onClose(),window.location.reload()}},Tt=class extends P{constructor(){super();this.contentEl.createDiv("message-container").createDiv({cls:"message mod-success",text:"Successfully added badge for you!"}),this.setTitle("Added Discord badge"),this.contentEl.append(jsx("p",null,"Thanks for supporting Obsidian! Your support helps us stay independent so we can pursue our vision."))}},xt=class extends te{constructor(e){super();this.setTitle("Couldn't add Discord badge"),this.contentEl.append(jsx("p",null,"Please contact us for support or try again later. We're really sorry for the inconvenience!")),this.showError(e)}},Ct=class extends P{constructor(){super();this.contentEl.createDiv("message-container").createDiv({cls:"message mod-success",text:"Successfully added badge for you!"}),this.setTitle("Added forum badge"),this.contentEl.append(jsx("p",null,"Thanks for supporting Obsidian! Your support helps us stay independent so we can pursue our vision."),jsx("p",null,'P.S. Your forum badge is not a "badge" in the forum system, but a shiny gold tag right next to your name in all of your posts. Hope that helps!'))}},Dt=class extends te{constructor(e){super();this.setTitle("Couldn't add forum badge"),this.contentEl.append(jsx("p",null,"Please contact us for support or try again later. We're really sorry for the inconvenience!")),this.showError(e)}},Lt=class extends X{constructor(){super();this.setTitle("Obsidian Unlimited"),this.summaryEl.hide()}createPayment(e){e.appendChild(jsx("p",null,"Thanks for supporting Obsidian! Your support helps us stay independent, so we can pursue our vision.")),e.createEl("p",{},t=>{t.createEl("label",{cls:"input-label",text:"Amount (USD)"}),this.donationEl=t.createEl("input",{type:"number",placeholder:"Pay what you want...",attr:{min:5,value:50,step:1}})}),this.donationEl.addEventListener("change",this.updatePrice.bind(this))}getPriceData(e){let t=this.donationEl.value;if(t==="")return null;let i=parseInt(t);return isNaN(i)||i<=0?null:{type:"donation",variation:(i*100).toString(),renew:""}}afterPay(){return o(this,null,function*(){window.location.reload()})}onOpen(){super.onOpen(),this.updatePrice(),this.setupPaypal(!1)}},Pt=class extends P{constructor(){super();this.setTitle("Pay with PayPal"),this.contentEl.appendChild(jsx(jsxFragment,null,jsx("p",null,"Paying with PayPal is currently a manual process, and we're working on automating it. Please do the following in order to get your payment processed:"),jsx("ol",{className:"u-pop"},jsx("li",null,jsx("span",{class:"mod-warning"},"Verify you're not paying a monthly fee.")," Because it's a manual process, we only accept yearly payments for Sync and Publish. Monthly payments will be refunded."),jsx("li",null,"Forward your PayPal receipt to ",jsx("a",{href:"mailto:support@obsidian.md"},"support@obsidian.md")," and specify what service you're purchasing.")),jsx("p",null,"Your payment should be processed within 3 business days."),jsx("p",null,"Thanks so much for your kind support! Obsidian couldn't have become what it is today without help from amazing people like you. Sorry for the trouble!"),jsx("p",{className:"u-center-text"},jsx("a",{href:"https://paypal.me/obsidianmd",target:"_blank"},jsx("img",{style:"width: 200px; background-color: #FFC439;border-radius: 24px;padding: 8px 40px;",src:"images/paypal-badge.png",alt:"Pay with PayPal"})))))}},q=v(()=>window.Stripe(ot)),Z=v(()=>q().elements().create("card",{style:{base:{color:"#dcddde",iconColor:"#dcddde",fontFamily:"Inter, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#888888"}},invalid:{fontFamily:"Inter, sans-serif",color:"#fa755a",iconColor:"#fa755a"}}}));ready(()=>{let a=fish(".login-form"),e=fish(".login-form .message.mod-error"),t=fish(".signup-form"),i=fish(".signup-form .message.mod-error"),s=fish(".welcome"),u=fish("#labeled-input-email"),p=fish("#labeled-input-password"),f=fish(".signup-name"),y=fish(".obsidian-signup-email"),w=fish(".signup-password"),F=fish(".welcome-name"),ne=fish(".welcome-email"),Ft=fish(".js-change-email"),Mt=fish(".modal-container.mod-change-email"),St=fish(".change-email-new-email"),At=fish(".change-email-password"),Rt=fish(".js-confirm-change-email"),M=fish(".modal-container.mod-change-email .message.mod-error"),Ht=fish(".js-change-name"),Bt=fish(".modal-container.mod-change-name"),It=fish(".change-name-new-name"),kt=fish(".js-confirm-change-name"),N=fish(".modal-container.mod-change-name .message.mod-error"),Nt=fish(".js-change-password"),_t=fish(".modal-container.mod-change-password"),Ut=fish(".change-password-old-password"),Ot=fish(".change-password-new-password"),Yt=fish(".js-confirm-change-password"),S=fish(".modal-container.mod-change-password .message.mod-error"),jt=fish(".js-delete-account"),qt=fish(".modal-container.mod-delete-account"),Xt=fish(".delete-account-password"),Vt=fish(".delete-account-email"),Gt=fish(".js-confirm-delete-account"),A=fish(".modal-container.mod-delete-account .message.mod-error"),_=fish(".modal-container.mod-change-info-success"),$t=fish(".js-logout"),De=fish(".card.mod-publish"),Le=fish(".card.mod-sync"),Pe=fish(".publish-site-num"),Fe=fish(".publish-renew-site-num"),Kt=fishAll(".publish-renewal-time"),Wt=fish(".publish-renew-info-renewing"),Me=fish(".publish-renew-info-not-renewing"),zt=fishAll(".js-view-payment-info"),Qt=fishAll(".js-open-change-payment"),Se=fish(".current-card-info"),Ae=fish(".modal-container.mod-change-payment-method"),Jt=fish(".modal-container.mod-change-payment-method .payment-form"),Zt=fish(".js-change-number-of-publish-sites"),ie=fish(".js-reduce-number-of-publish-sites"),Re=fish(".js-change-publish-to-monthly"),He=fish(".js-change-publish-to-yearly"),Be=fish(".setting-item-description.mod-publish-frequency"),Ie=fish(".publish-reduce-sites-num"),en=fish(".js-update-reduce-sites"),ke=fish(".js-stop-publish-auto-renewal"),tn=fish(".commercial-license-pitch"),nn=fish(".existing-commercial-license"),T=fish(".commercial-license-key"),an=fish(".commercial-license-company-name"),sn=fishAll(".commercial-license-seat-number"),Ne=fish(".card.mod-commercial-license"),rn=fish(".catalyst-tier"),_e=fish(".catalyst-upgrade-button"),ln=fishAll(".js-close-modal, .modal-close-button, .modal-bg"),Ue=fish(".card.mod-catalyst"),E=fish(".loader-cube"),on=fish(".js-go-to-signup"),cn=fish(".js-go-to-login"),un=fish(".js-go-to-forgot-pass"),Oe=fish(".forgot-pass-form"),ae=fish(".forgot-pass-form .message.mod-success"),R=fish(".forgot-pass-form .message.mod-error"),dn=fish(".forgot-pass-email"),Ye=fish(".reset-pass-form"),hn=fish(".forgot-pass-email-container"),mn=fish(".reset-pass-password"),se=fish(".reset-pass-form .message.mod-success"),U=fish(".reset-pass-form .message.mod-error"),pn=fish(".js-request-forgot"),re=null,fn=fish(".js-upgrade-publish"),yn=fish(".modal-container.mod-publish-reduce-sites"),En=fish(".modal-container.mod-view-payment-method"),gn=fish(".js-open-unlimited"),wn=fish(".setting-item.mod-obsidian-credit"),bn=fish(".obsidian-credit-amount"),Fi=fish(".donation-amount-input"),vn=fish(".donation-amount"),Tn=fishAll(".modal-container"),xn=fish(".js-upgrade-sync"),le=fish(".js-change-sync-to-monthly"),oe=fish(".js-change-sync-to-yearly"),ce=fish(".js-stop-sync-auto-renewal"),Cn=fishAll(".sync-renewal-time"),je=fish(".sync-renew-info-renewing"),ue=fish(".sync-renew-info-not-renewing"),qe=fish(".setting-item-description.mod-sync-frequency"),Dn=fishAll(".commercial-renewal-time"),de=fish(".js-resume-commercial-auto-renewal"),V=fish(".js-stop-commercial-auto-renewal"),he=fish(".commercial-renew-info-renewing"),G=fish(".commercial-renew-info-not-renewing"),Ln=fishAll(".commercial-license-expiry-date"),Pn=fishAll(".checkbox-container"),Fn=fishAll(".claim-discord-badge-button"),Mn=fishAll(".claim-forum-badge-button"),Sn=fish(".js-commercial-license-change-seat"),An=fish(".js-commercial-license-reduce-seat"),Rn=fish(".modal-container.mod-commercial-license-reduce-seats"),Hn=fish(".commercial-license-reduce-seat-input"),Bn=fish(".js-update-reduce-seats"),H=fish(".modal-container.mod-commercial-license-reduce-seats .payment-error"),me={monthly:10,yearly:8,yearlyPromo:"20% off compared to monthly"},pe={monthly:20,yearly:16,yearlyPromo:"20% off compared to monthly"},fe=v(()=>new bt),In=v(()=>new ft(me)),Xe=v(()=>new yt(pe)),Ve=v(()=>new Et),kn=v(()=>new Lt),$="",K=!1,Ge=null,$e=null,x=!1,C=null,Nn=q(),ye=Z(),W=null,D=()=>{if(x){window.location.reload();return}ye.unmount(),Tn.forEach(n=>n.hide()),x=!1},g=I.decodeUrlQuery(Y);if(g.mode&&g.mode==="signup")Te(),E.hide(),t.show(),K=!0;else if(g.mode&&g.mode==="forgotpass")Te(),E.hide(),Oe.show(),K=!0;else if(g.hasOwnProperty("forgetpw")&&g.id&&g.key)Te(),Ge=g.id,$e=g.key,E.hide(),Ye.show(),K=!0;else if(g.stripe&&g.stripe==="complete"){let n=g.session}else g.discount&&(g.discount==="verified"?fish(".modal-container.mod-discount-verified").show():g.discount==="approved"&&g.type&&(fish(".approved-discount-type").setText(g.type),fish(".modal-container.mod-discount-approved").show()));W=I.decodeUrlQuery(j),console.log(W),W.code&&o(void 0,null,function*(){try{yield c(Ei,{code:W.code}),new Tt().open()}catch(n){new xt(n).open()}});let _n=()=>o(void 0,null,function*(){let n;try{n=yield c(ei,{})}catch(r){K||(E.hide(),a.show());return}if(F.setText(n.name),ne.setText(n.email),n.donation&&vn.setText(ee(n.donation)),t.hide(),E.hide(),s.show(),n.license&&($=n.license),$?(Ue.addClass("is-active"),rn.setText(n.license),fe().setTier($),$!=="vip"&&(_e.addEventListener("click",()=>{fe().open()}),_e.show())):Ue.addEventListener("click",()=>{fe().open()}),wn.toggle(n.credit!==0),bn.setText(ee(n.credit)),n.discount){let{type:r,expiry:l}=n.discount;fish(".setting-item.mod-discount .setting-item-description").setText(`Your ${r} discount currently gives you 40% off the regular price of Obsidian Sync and Publish. Your discount will expire on ${new Date(l).toLocaleDateString()}.`),fish(".setting-item.mod-discount .setting-item-control a").setText("Renew")}}),Un=()=>o(void 0,null,function*(){let n=yield c(ui,{});if(n.business&&n.business.expiry>=Date.now()){C=n.business,T.setText(C.key),an.setText(C.company);let r=C.seats,l=r===1?"1 seat":r+" seats";sn.forEach(h=>h.setText(l)),Ln.forEach(h=>h.setText(new Date(C.expiry).toLocaleDateString())),tn.hide(),nn.show()}else Ne.addEventListener("click",()=>Ve().setStatus(0,!0).open());if(n.publish){let{sites:r,renew:l,renew_sites:h,expiry_ts:m,earlybird:B}=n.publish;if(m>=Date.now()){if(De.addClass("is-active"),r===1?Pe.setText("1 site"):Pe.setText(`${r} sites`),h===1?(Fe.setText("1 site"),ie.hide()):(Fe.setText(`${h} sites`),ie.show()),m){let ge=new Date(m);Kt.forEach(we=>we.setText(`on ${ge.toLocaleDateString()}`))}Me.hide();let b=document.createDocumentFragment();l==="yearly"?(He.hide(),b.createSpan({text:"You're currently on a "}),b.createSpan({cls:"u-pop",text:"yearly"}),b.createSpan({text:" plan."})):l==="monthly"?(Re.hide(),b.createSpan({text:"You're currently on a "}),b.createSpan({cls:"u-pop",text:"monthly"}),b.createSpan({text:" plan."})):l===""&&(ke.hide(),Me.show(),Wt.hide(),b.createSpan({text:"You're not currently being renewed."})),Be.empty(),Be.appendChild(b),Ie.value=r}B===!0&&(pe.yearly/=2,pe.monthly/=2,De.addClass("is-early-bird"))}if(n.sync){let{renew:r,expiry_ts:l,earlybird:h}=n.sync;if(l>=Date.now()){if(Le.addClass("is-active"),l){let B=new Date(l);Cn.forEach(b=>b.setText(`on ${B.toLocaleDateString()}`))}ue.hide(),r==="yearly"||(r==="monthly"?le.hide():r===""&&(ce.hide(),ue.show(),je.hide()));let m=document.createDocumentFragment();r==="yearly"?(oe.hide(),m.createSpan({text:"You're currently on a "}),m.createSpan({cls:"u-pop",text:"yearly"}),m.createSpan({text:" plan."})):r==="monthly"?(le.hide(),m.createSpan({text:"You're currently on a "}),m.createSpan({cls:"u-pop",text:"monthly"}),m.createSpan({text:" plan."})):r===""&&(ce.hide(),ue.show(),je.hide(),m.createSpan({text:"You're not currently being renewed."})),qe.empty(),qe.appendChild(m)}h===!0&&(me.yearly/=2,me.monthly/=2,Le.addClass("is-early-bird"))}if(n.business){let{renew:r,expiry:l}=n.business;if(l>=Date.now()){if(Ne.addClass("is-active"),l){let h=new Date(l);Dn.forEach(m=>m.setText(`on ${h.toLocaleDateString()}`))}G.hide(),r==="yearly"?(de.hide(),V.show(),G.hide(),he.show()):r===""&&(de.show(),V.hide(),G.show(),he.hide()),r==="yearly"?oe.hide():r===""&&(V.hide(),G.show(),he.hide())}}}),On=()=>o(void 0,null,function*(){e.hide(),a.hide(),E.show();let n=u.value,r=p.value,l=!1;if(n===""?(e.setText("Email cannot be empty."),l=!0):n.indexOf("@")===-1?(e.setText("Email is not valid."),l=!0):r===""&&(e.setText("Password cannot be empty."),l=!0),l){a.show(),E.hide(),e.show();return}try{yield c(ti,{email:u.value,password:p.value}),window.location.reload()}catch(h){a.show(),E.hide(),h==="Login failed"&&(e.setText("Login failed, please double check your email and password."),e.show())}}),Yn=()=>o(void 0,null,function*(){i.hide(),t.hide(),E.show();let n=f.value,r=y.value,l=w.value,h=!1;if(n===""?(i.setText("Name cannot be empty."),h=!0):r===""?(i.setText("Email cannot be empty."),h=!0):r.indexOf("@")===-1?(i.setText("Email is not valid."),h=!0):l===""&&(i.setText("Password cannot be empty."),h=!0),h){i.show(),t.show(),E.hide();return}try{yield c(ni,{name:n,email:r,password:l}),window.location.reload()}catch(m){t.show(),E.hide(),m==="Invalid email address"?i.setText("The email address you entered was invalid."):m==="Already signed up"&&i.setText("Seems like you already have an account! Please log in."),i.show()}}),jn=()=>o(void 0,null,function*(){R.hide(),ae.hide();let n=dn.value;if(n){if(n.indexOf("@")===-1){R.setText('Email address is not valid and must contain "@".'),R.show();return}}else{R.setText("Please fill out your email."),R.show();return}E.show();try{yield c(ai,{email:n,captcha:"captcha"}),ae.setText(`We have sent an email to ${n} to reset your password.`),ae.show(),hn.hide(),pn.hide(),E.hide()}catch(r){R.setText("Something went wrong, please try again."),R.show(),E.hide()}}),qn=()=>o(void 0,null,function*(){se.hide(),U.hide();let n=mn.value;if(!n){U.setText("Please set a new password."),U.show();return}try{yield c(si,{password:n,id:Ge,key:$e}),se.innerHTML='Your password has been successfully set. <a href="/account">Log in</a>',se.show()}catch(r){U.setText("Something went wrong, please try again."),U.show()}}),Xn=()=>o(void 0,null,function*(){yield c(ii,{}),window.location.reload()});_n(),Un(),$t.addEventListener("click",()=>{Xn()});let Ee=()=>{let n=T.getText();nt(n),T.setText("Copied!"),T.addClass("is-copied"),T.removeEventListener("click",Ee),setTimeout(()=>{T.removeClass("is-copied"),T.setText(n),T.addEventListener("click",Ee)},500)};T.addEventListener("click",Ee),ln.forEach(n=>{n.addEventListener("click",D)}),on.addEventListener("click",()=>{location.hash="#mode=signup",location.reload()}),cn.addEventListener("click",()=>{location.hash="",location.reload()}),un.addEventListener("click",()=>{location.hash="#mode=forgotpass",location.reload()}),a.find("form").addEventListener("submit",n=>{n.preventDefault(),On()}),t.find("form").addEventListener("submit",n=>{n.preventDefault(),Yn()}),Oe.find("form").addEventListener("submit",n=>{n.preventDefault(),jn()}),Ye.find("form").addEventListener("submit",n=>{n.preventDefault(),qn()}),fn.addEventListener("click",()=>Xe().open()),Re.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"publish",renew:"monthly"}),window.location.reload()})),He.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"publish",renew:"yearly"}),window.location.reload()})),ke.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"publish",renew:""}),window.location.reload()})),Zt.addEventListener("click",()=>Xe().open()),ie.addEventListener("click",()=>{yn.show()}),en.addEventListener("click",()=>o(void 0,null,function*(){let n=parseInt(Ie.value);yield c(pi,{sites:n}),window.location.reload()})),zt.forEach(n=>n.addEventListener("click",()=>o(void 0,null,function*(){let r=yield c(fi,{});r.info?Se.setText(`You're currently using a ${r.info}.`):Se.setText("You currently do not have any payment methods on file."),En.show()}))),Qt.forEach(n=>n.addEventListener("click",()=>{Ae.show(),re=Ae.find(".payment-error"),ye.mount(".modal-container.mod-change-payment-method .card-element")})),Jt.addEventListener("submit",n=>{n.preventDefault(),Nn.createPaymentMethod({type:"card",card:ye}).then(r=>o(void 0,null,function*(){r.paymentMethod&&r.paymentMethod.id?(yield c(yi,{payment_method_id:r.paymentMethod.id}),window.location.reload()):(re.setText("Could not update your payment method."),re.show())}))}),gn.addEventListener("click",()=>{kn().open()}),xn.addEventListener("click",()=>In().open()),le.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"sync",renew:"monthly"}),window.location.reload()})),oe.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"sync",renew:"yearly"}),window.location.reload()})),ce.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"sync",renew:""}),window.location.reload()})),V.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"business",renew:""}),window.location.reload()})),de.addEventListener("click",()=>o(void 0,null,function*(){yield c(L,{type:"business",renew:"yearly"}),window.location.reload()})),Pn.forEach(n=>{n.addEventListener("click",()=>{n.hasClass("is-enabled")?n.removeClass("is-enabled"):n.addClass("is-enabled")})}),Fn.forEach(n=>n.addEventListener("click",()=>ut(n))),Mn.forEach(n=>n.addEventListener("click",()=>dt(n))),Ft.addEventListener("click",()=>{Mt.show()}),Rt.addEventListener("click",()=>o(void 0,null,function*(){M.hide();let n=St.value,r=At.value;if(n===""){M.setText("New email cannot be empty."),M.show();return}if(r===""){M.setText("Password cannot be empty."),M.show();return}try{yield c(li,{password:r,email:n}),D(),x=!0,_.show()}catch(l){M.setText(l),M.show()}})),Ht.addEventListener("click",()=>{Bt.show()}),kt.addEventListener("click",()=>o(void 0,null,function*(){N.hide();let n=It.value;if(n===""){N.setText("New name cannot be empty."),N.show();return}try{yield c(ri,{name:n}),D(),x=!0,_.show()}catch(r){N.setText(r),N.show()}})),Nt.addEventListener("click",()=>{_t.show()}),Yt.addEventListener("click",()=>o(void 0,null,function*(){S.hide();let n=Ut.value,r=Ot.value;if(n===""){S.setText("Current password cannot be empty."),S.show();return}if(n===""){S.setText("New password cannot be empty."),S.show();return}try{yield c(oi,{old_password:n,new_password:r}),D(),x=!0,_.show()}catch(l){S.setText(l),S.show()}})),jt.addEventListener("click",()=>{qt.show()}),Gt.addEventListener("click",()=>o(void 0,null,function*(){A.hide();let n=Vt.value,r=Xt.value;if(n===""){A.setText("Please enter your email to confirm account deletion."),A.show();return}if(r===""){A.setText("Please enter your password to confirm account deletion."),A.show();return}try{yield c(ci,{email:n,password:r}),D(),x=!0,_.show()}catch(l){A.setText(l),A.show()}})),Sn.addEventListener("click",()=>{Ve().setStatus(C.seats,!!C.renew).open()}),An.addEventListener("click",()=>{Rn.show()}),Bn.addEventListener("click",()=>o(void 0,null,function*(){H.hide();let n=Hn.valueAsNumber,r=C.seats;if(n===0){H.setText("The number of seats to remove cannot be 0."),H.show();return}let l=r-n;if(l<0){let h=r===1?"1 seat":r+" seats";H.setText("You currently have "+h+" and cannot remove more seats than that."),H.show();return}try{yield c(mi,{seats:l}),D(),x=!0,_.show()}catch(h){H.setText(h),H.show()}}));let Ke="",We="stripe",ze=fish(".modal-container.mod-invoice-list");fish(".js-view-invoices").addEventListener("click",()=>o(void 0,null,function*(){E.show(),s.hide();let n=yield c(wi,{});E.hide(),s.show(),ze.show();let r=ze.find(".invoice-list");r.empty();for(let l of n)r.createDiv({cls:"invoice-item setting-item"},h=>{h.createDiv({cls:"setting-item-info"},m=>{m.createDiv({text:l.description,cls:"setting-item-name"}),m.createDiv({text:new Date(l.created).toLocaleString(),cls:"setting-item-description"})}),h.createDiv({cls:"setting-item-control mod-vertical"},m=>{m.createEl("button",{cls:"mod-cta",text:"View"},B=>{B.addEventListener("click",()=>{let b=(l.amount/100).toFixed(2),ge=(l.refunded/100).toFixed(2),we=((l.amount-l.refunded)/100).toFixed(2),Vn=l.refunded!==0,Je=localStorage.getItem("billing-info");fish(".invoice-date").setText(new Date(l.created).toLocaleString()),fish(".invoice-number-title").setText(l.receipt_number||l.id),fish(".invoice-number").setText(l.receipt_number||l.id),fish(".invoice-description").setText(l.description),fish(".invoice-amount").setText(b),Vn?(fish(".invoice-box .item.mod-refund").show(),fish(".invoice-refund-amount").setText(ge)):fish(".invoice-box .item.mod-refund").hide(),fish(".invoice-total").setText(we),Je&&fish(".billing-info").setText(Je),fish(".billing-info").addEventListener("input",()=>{let Gn=fish(".billing-info").getText();localStorage.setItem("billing-info",Gn)}),fish(".modal-container.mod-invoice-detail").show()})}),l.refundable&&m.createEl("a",{text:"Get refund"},B=>{B.addEventListener("click",()=>{Ke=l.id,We=l.type,fish(".modal-container.mod-confirm-refund").show()})})})})})),fish(".js-confirm-refund").addEventListener("click",()=>o(void 0,null,function*(){fish(".modal-container.mod-invoice-list").hide(),fish(".modal-container.mod-confirm-refund").hide(),E.show(),s.hide();try{yield c(bi,{charge:Ke,type:We}),x=!0,fish(".modal-container.mod-refund-success").show()}catch(n){fish(".refund-failed-reason").setText(n),fish(".modal-container.mod-refund-failed").show()}E.hide(),s.show()}));let z=function(n,r){let l=n.find(".message");l.setText(r),l.toggle(r!=="")},O=fish(".modal-container.mod-apply-for-discount"),Qe=fish("#apply-discount-email");fish(".js-apply-for-discount").addEventListener("click",()=>{D(),z(O,""),Qe.value="",O.show()}),fish(".js-send-discount-application").onClickEvent(()=>o(void 0,null,function*(){let n=fish('input[name="apply-discount-type"]:checked').value,r=Qe.value;if(!n){z(O,"Please select a discount type.");return}if(r===""||!r.contains("@")){z(O,"Please enter a valid organization email address.");return}try{yield c(xi,{type:n,email:r}),D(),fish(".modal-container.mod-discount-application-success").show()}catch(l){z(O,l)}}))});})();
