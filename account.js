(()=>{var a=(u,i,l)=>new Promise((o,d)=>{var g=C=>{try{K(l.next(C))}catch(W){d(W)}},A=C=>{try{K(l.throw(C))}catch(W){d(W)}},K=C=>C.done?o(C.value):Promise.resolve(C.value).then(g,A);K((l=l.apply(u,i)).next())});function bt(u){if(!navigator.clipboard||!navigator.permissions){let i=document.createElement("textarea");i.value=u,i.style.top="0",i.style.left="0",i.style.position="fixed",document.body.appendChild(i);try{i.focus(),i.select(),document.execCommand("copy")}catch(l){}document.body.removeChild(i);return}navigator.clipboard.writeText(u)}var Wi=window.requestIdleCallback;var Gi=/bot|crawl|spider/i.test(navigator.userAgent);var gi=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){gi={passive:!1}}}))}catch(u){}function wi(u){return new Promise((i,l)=>{let o=document.createElement("script");o.type="text/javascript",o.src=u,o.addEventListener("load",()=>i(o)),o.addEventListener("error",d=>l(d)),document.body.appendChild(o)})}function _e(u,i){let l=!1,o=null;return{get loaded(){return l},get promise(){if(l)return Promise.resolve();if(!o){i&&i.before&&i.before();let d=wi(u);d.catch(g=>{g.detach(),o=null}),o=d.then(()=>{l=!0,o=null,i&&i.after&&i.after()})}return o},then(d){return l?d():this.promise.then(d)}}}var Tt=new Map;for(let u of"a abbr acronym b bdi bdo big br button canvas cite code data del dfn em embed i iframe img input ins kbd label map mark meter noscript object outputpicture progress q ruby s samp select small span strong sub sup svg textarea time u tt var video wbr".split(" "))Tt.set(u,!0);for(let u of"address article aside blockquote details dialog dd div dl dt fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr li main nav ol p pre ul".split(" "))Tt.set(u,!1);function vt(u){let i=null,l=()=>(i||(i=new Promise((o,d)=>a(this,null,function*(){try{o(yield u())}catch(g){d(g)}}))),i);return{then(o,d){return l().then(o,d)},catch(o){return l().catch(o)},finally(o){return l().finally(o)},get[Symbol.toStringTag](){return l()[Symbol.toStringTag]}}}var Y=class{static encodeUrlQuery(i){if(!i)return"";let l=[];for(let o in i)i.hasOwnProperty(o)&&i[o]&&(i[o]===!0?l.push(encodeURIComponent(o)):l.push(encodeURIComponent(o)+"="+encodeURIComponent(i[o])));return l.join("&")}static decodeUrlQuery(i){let l={};if(!i||i.trim()==="")return l;let o=i.split("&");for(let d=0;d<o.length;d++){let g=o[d].split("=");if(g.length>=1&&g[0]){let A=decodeURIComponent(g[0]);g.length===2?l[A]=decodeURIComponent(g[1]):l[A]=""}}return l}static decodeUrl(i){i||(i="");let l=i.split("#"),o=l.length>1?l[1]:"",d=l[0].split("?"),g=d.length>1?d[1]:"";return{path:d[0],query:Y.decodeUrlQuery(g),hash:Y.decodeUrlQuery(o)}}};function fe(u,i,l){return"https://raw.githubusercontent.com/"+u+"/"+(l||"HEAD")+"/"+i}function c(u,i){return a(this,null,function*(){let l;try{l=yield ajaxPromise({method:"POST",url:u,data:i})}catch(o){throw o.error?o.error:o}if(l=JSON.parse(l),l.error)throw l.error;return l})}var eo=fe("obsidianmd/obsidian-releases","community-plugins.json");var to=fe("obsidianmd/obsidian-releases","community-plugin-stats.json");var no=fe("obsidianmd/obsidian-releases","community-css-themes.json");var Lt=location.host.startsWith("127.0.0.1")||location.host.startsWith("localhost"),h="https://api.obsidian.md";Lt&&(h="http://127.0.0.1:3000");var Ei=h+"/user/info",bi=h+"/user/signin",Ti=h+"/user/signup",vi=h+"/user/signout",xi=h+"/user/forgetpass",Li=h+"/user/resetpass",Ci=h+"/user/changename",Si=h+"/user/changeemail",Pi=h+"/user/changepass",Mi=h+"/user/deleteaccount",Ri=h+"/subscription/list",xt=h+"/subscription/pay",Ai=h+"/subscription/stripe/end",ne=h+"/subscription/price",Ii=h+"/subscription/business/rename",Di=h+"/subscription/business/reduce",N=h+"/subscription/renew",ki=h+"/subscription/publish/reduce",Ni=h+"/subscription/paymentmethod",_i=h+"/subscription/stripe/paymentmethod",Hi=h+"/subscription/role/discord",Ui=h+"/subscription/role/forum",Fi=h+"/subscription/invoice/list",Bi=h+"/subscription/invoice/refund",Oi=h+"/subscription/paypal/clientid",Ct="pk_live_vqeOYADfYPpqKDT5FtAqCNBP00a9WEhYa6";Lt&&(Ct="pk_test_y7CBP7qLG6kSU9sdcHV5S2db0052OC4wR8");function He(){history.pushState?history.pushState("",document.title,window.location.pathname+window.location.search):location.hash=""}function j(u){let i=(u/100).toFixed(2).toString().toString().split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")}var ie=location.hash;ie&&ie.length>1&&(ie=ie.substr(1));var oe=location.search;oe&&oe.length>1&&(oe=oe.substr(1));var Yi=_e("https://js.braintreegateway.com/web/3.85.2/js/client.min.js"),ji=_e("https://js.braintreegateway.com/web/3.85.2/js/paypal-checkout.min.js"),qi=vt(()=>a(void 0,null,function*(){yield Yi,yield ji;let u=yield c(Oi,{}),i=window.braintree,l=yield i.client.create({authorization:u.clientid}),o=yield i.paypalCheckout.create({client:l});yield o.loadPayPalSDK({vault:!0,currency:"CAD",intent:"capture"});let d=window.paypal;return{braintree:i,paypalCheckout:o,paypal:d}}));ready(()=>{let u=fish(".login-form"),i=fish(".login-form .message.mod-error"),l=fish(".signup-form"),o=fish(".signup-form .message.mod-error"),d=fish(".welcome"),g=fish("#labeled-input-email"),A=fish("#labeled-input-password"),K=fish(".signup-name"),C=fish(".obsidian-signup-email"),W=fish(".signup-password"),St=fish(".welcome-name"),Pt=fish(".welcome-email"),Mt=fish(".js-change-email"),Rt=fish(".modal-container.mod-change-email"),At=fish(".change-email-new-email"),It=fish(".change-email-password"),Dt=fish(".js-confirm-change-email"),_=fish(".modal-container.mod-change-email .message.mod-error"),kt=fish(".js-change-name"),Nt=fish(".modal-container.mod-change-name"),_t=fish(".change-name-new-name"),Ht=fish(".js-confirm-change-name"),G=fish(".modal-container.mod-change-name .message.mod-error"),Ut=fish(".js-change-password"),Ft=fish(".modal-container.mod-change-password"),Bt=fish(".change-password-old-password"),Ot=fish(".change-password-new-password"),Yt=fish(".js-confirm-change-password"),H=fish(".modal-container.mod-change-password .message.mod-error"),jt=fish(".js-delete-account"),qt=fish(".modal-container.mod-delete-account"),Xt=fish(".delete-account-password"),Kt=fish(".delete-account-email"),Wt=fish(".js-confirm-delete-account"),U=fish(".modal-container.mod-delete-account .message.mod-error"),z=fish(".modal-container.mod-change-info-success"),Gt=fish(".js-logout"),Ue=fish(".card.mod-publish"),Fe=fish(".card.mod-sync"),Be=fish(".publish-site-num"),Oe=fish(".publish-renew-site-num"),zt=fishAll(".publish-renewal-time"),$t=fish(".publish-renew-info-renewing"),Ye=fish(".publish-renew-info-not-renewing"),Vt=fishAll(".js-view-payment-info"),Qt=fishAll(".js-open-change-payment"),je=fish(".current-card-info"),qe=fish(".modal-container.mod-change-payment-method"),Jt=fish(".modal-container.mod-change-payment-method .payment-form"),Zt=fish(".js-change-number-of-publish-sites"),pe=fish(".js-reduce-number-of-publish-sites"),Xe=fish(".js-change-publish-to-monthly"),Ke=fish(".js-change-publish-to-yearly"),We=fish(".setting-item-description.mod-publish-frequency"),Ge=fish(".publish-reduce-sites-num"),en=fish(".js-update-reduce-sites"),ze=fish(".js-stop-publish-auto-renewal"),tn=fish(".commercial-license-pitch"),nn=fish(".existing-commercial-license"),$e=fish(".business-name-input"),S=fish(".commercial-license-key"),on=fish(".commercial-license-company-name"),ln=fishAll(".commercial-license-seat-number"),Ve=fish(".card.mod-commercial-license"),ye=fish(".modal-container.mod-commercial-license"),an=fish(".modal-container.mod-commercial-license .modal-title"),Qe=fish(".modal-container.mod-personal-license"),sn=fish(".catalyst-tier"),Je=fish(".catalyst-upgrade-button"),rn=fishAll(".js-close-modal, .modal-close-button, .modal-bg"),Ze=fish(".card.mod-catalyst"),et=fish('.card[data-tier="insider"]'),cn=fish('.card[data-tier="supporter"]'),ge=fishAll(".modal-container.mod-personal-license .card"),dn=fish(".modal-container.mod-personal-license .payment-form"),un=fish(".modal-container.mod-commercial-license .payment-form"),mn=fish(".commercial-license-auto-renewal"),f=fish(".loader-cube"),hn=fish(".js-go-to-signup"),fn=fish(".js-go-to-login"),pn=fish(".js-go-to-forgot-pass"),tt=fish(".forgot-pass-form"),we=fish(".forgot-pass-form .message.mod-success"),F=fish(".forgot-pass-form .message.mod-error"),yn=fish(".forgot-pass-email"),nt=fish(".reset-pass-form"),gn=fish(".forgot-pass-email-container"),wn=fish(".reset-pass-password"),Ee=fish(".reset-pass-form .message.mod-success"),$=fish(".reset-pass-form .message.mod-error"),En=fish(".js-request-forgot"),it=fish(".modal-container.mod-personal-license .payment-container"),q=fish(".commercial-license-seat"),r=null,bn=fish(".js-upgrade-publish"),le=fish(".modal-container.mod-choose-publish-plan"),Tn=fish(".modal-container.mod-publish-reduce-sites"),vn=fish(".modal-container.mod-view-payment-method"),be=le.findAll(".card"),ot=le.find(".publish-sites-num"),xn=fish(".modal-container.mod-choose-publish-plan .payment-form"),Ln=fish(".js-open-unlimited"),lt=fish(".modal-container.mod-donation"),Cn=fish(".modal-container.mod-donation .payment-form"),Sn=fish(".setting-item.mod-obsidian-credit"),Pn=fish(".obsidian-credit-amount"),Te=fish(".donation-amount-input"),Mn=fish(".donation-amount"),Rn=fishAll(".modal-container"),An=fish(".js-upgrade-sync"),ae=fish(".modal-container.mod-choose-sync-plan"),ve=ae.findAll(".card"),In=ae.find(".payment-form"),xe=fish(".js-change-sync-to-monthly"),Le=fish(".js-change-sync-to-yearly"),Ce=fish(".js-stop-sync-auto-renewal"),Dn=fishAll(".sync-renewal-time"),at=fish(".sync-renew-info-renewing"),Se=fish(".sync-renew-info-not-renewing"),st=fish(".setting-item-description.mod-sync-frequency"),kn=fishAll(".commercial-renewal-time"),Pe=fish(".js-resume-commercial-auto-renewal"),se=fish(".js-stop-commercial-auto-renewal"),Me=fish(".commercial-renew-info-renewing"),re=fish(".commercial-renew-info-not-renewing"),Nn=fishAll(".commercial-license-expiry-date"),_n=fishAll(".checkbox-container"),Hn=fishAll(".claim-discord-badge-button"),Un=fishAll(".claim-forum-badge-button"),Fn=fish(".modal-container.mod-discord-success"),Bn=fish(".modal-container.mod-discord-failure"),On=fish(".modal-container.mod-forum-success"),Yn=fish(".modal-container.mod-forum-failure"),jn=fish(".modal-container.mod-discord-failure .message.mod-error"),qn=fish(".modal-container.mod-forum-failure .message.mod-error"),Xn=fish(".modal-container.mod-catalyst-payment-success"),Kn=fish(".modal-container.mod-publish-payment-success"),Wn=fish(".modal-container.mod-sync-payment-success"),Gn=fish(".js-commercial-license-change-seat"),zn=fish(".js-commercial-license-reduce-seat"),$n=fish(".modal-container.mod-commercial-license-reduce-seats"),Vn=fish(".commercial-license-reduce-seat-input"),Qn=fish(".js-update-reduce-seats"),B=fish(".modal-container.mod-commercial-license-reduce-seats .payment-error"),Jn=fishAll(".paypal-temp-button"),Zn=fish(".modal-container.mod-paypal-pay"),ei={base:{color:"#dcddde",iconColor:"#dcddde",fontFamily:"Inter, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#888888"}},invalid:{fontFamily:"Inter, sans-serif",color:"#fa755a",iconColor:"#fa755a"}},V="",p=null,w=null,I=null,ce=!1,rt=null,ct=null,T=!1,D=null,X=!1,Re="card",Q=window.Stripe(Ct),v=Q.elements().create("card",{style:ei}),O=null,de=function(e){return a(this,null,function*(){try{yield c(Ai,{intent_id:e}),dt()}catch(t){r.setText(t),r.show()}x(!1)})},dt=()=>a(void 0,null,function*(){let e=$e.value;if(p==="business"&&!X)try{yield c(Ii,{company:e}),window.location.reload()}catch(t){r.setText(t),r.show()}else p==="catalyst"?(L(),T=!0,Xn.show()):p==="publish"?(L(),T=!0,Kn.show()):p==="sync"?(L(),T=!0,Wn.show()):O.payment_intent?window.location.search="":window.location.reload()}),L=()=>{if(T){window.location.reload();return}v.unmount(),it.hide(),Rn.forEach(e=>e.hide()),ge.forEach(e=>e.removeClass("is-selected")),T=!1},b=Y.decodeUrlQuery(ie);if(b.mode&&b.mode==="signup")He(),f.hide(),l.show(),ce=!0;else if(b.mode&&b.mode==="forgotpass")He(),f.hide(),tt.show(),ce=!0;else if(b.hasOwnProperty("forgetpw")&&b.id&&b.key)He(),rt=b.id,ct=b.key,f.hide(),nt.show(),ce=!0;else if(b.stripe&&b.stripe==="complete"){let e=b.session}O=Y.decodeUrlQuery(oe),O.code?a(void 0,null,function*(){window.history.replaceState(null,null,window.location.pathname);try{yield c(Hi,{code:O.code}),Fn.show()}catch(e){jn.setText(e),Bn.show()}}):O.redirect_status==="succeeded"&&O.payment_intent&&de(O.payment_intent),dn.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),x(!0),Z()}),fishAll(".wechat-pay-button").forEach(e=>{e.addEventListener("click",()=>a(void 0,null,function*(){fishAll(".payment-error").forEach(t=>t.hide()),x(!0),ni(yield me("wechat"))}))}),fishAll(".alipay-button").forEach(e=>{e.addEventListener("click",()=>a(void 0,null,function*(){fishAll(".payment-error").forEach(t=>t.hide()),x(!0),ii(yield me("alipay"))}))}),un.addEventListener("submit",function(e){if(e.preventDefault(),fishAll(".payment-error").forEach(n=>n.hide()),!$e.value&&!X){r.setText("Please enter a business name."),r.show();return}X?I=D.renew:mn.hasClass("is-enabled")?I="yearly":I="",x(!0),Z()});let ti=function(e,t){r.hide(),Q.confirmCardPayment(t,{payment_method:{card:e}}).then(function(n){n.error?(x(!1),r.setText(n.error.message),r.show()):de(n.paymentIntent.id)})},ni=function(e){r.hide(),Q.confirmWechatPayPayment(e,{payment_method_options:{wechat_pay:{client:"web"}}}).then(function(t){t.error?(x(!1),r.setText(t.error.message),r.show()):de(t.paymentIntent.id)})},ii=function(e){r.hide(),Q.confirmAlipayPayment(e,{return_url:window.location.href}).then(function(t){t.error?(x(!1),r.setText(t.error.message),r.show()):de(t.paymentIntent.id)})};function J(e){return a(this,null,function*(){return;try{let m=["sync","publish","business"].contains(p),E=yield c(ne,{type:p,renew:I,variation:w}),y=(E.total*E.usdToCad/100).toFixed(2),P={fundingSource:s.FUNDING.PAYPAL,style:{layout:"horizontal",shape:"pill"},onApprove:function(R,ee){return a(this,null,function*(){L(),f.show(),d.hide();try{let k=yield n.tokenizePayment(R);yield c(xt,{method:"paypal",type:p,variation:w,renew:I,nonce:k.nonce}),location.reload()}catch(k){console.error(k),alert(k),f.hide(),d.show()}})},onCancel:function(R){console.log("PayPal payment cancelled",JSON.stringify(R))},onError:function(R){console.error("PayPal error",R)}};m?P.createBillingAgreement=function(){return n.createPayment({flow:s.FlowType.Checkout,intent:s.Intent.Capture,currency:"CAD",amount:y,requestBillingAgreement:!0,billingAgreementDetails:{description:E.desc}})}:P.createOrder=function(){return n.createPayment({flow:s.FlowType.Checkout,intent:s.Intent.Capture,currency:"CAD",amount:y})};let M=`#${e}-paypal-button`;fish(M).empty(),s.Buttons(P).render(M)}catch(m){console.error(m)}})}let ue=function(e,t){let n=t.find(".payment-line.mod-subtotal"),s=t.find(".payment-line.mod-subtotal .payment-desc"),m=t.find(".payment-line.mod-subtotal .payment-amount"),E=t.find(".payment-line.mod-discount"),y=t.find(".payment-line.mod-discount .payment-desc"),P=t.find(".payment-line.mod-discount .payment-amount"),M=t.find(".payment-line.mod-tax"),R=t.find(".payment-line.mod-tax .payment-desc"),ee=t.find(".payment-line.mod-tax .payment-amount"),k=t.find(".payment-line.mod-credit"),ui=t.find(".payment-line.mod-credit .payment-amount"),pt=t.find(".payment-line.mod-total .payment-desc"),mi=t.find(".payment-line.mod-total .payment-amount"),yt=t.find("button.submit"),hi=t.find(".card-element"),fi=t.find(".stripe-badge"),{subtotal:gt,desc:wt,tax:De,taxDesc:pi,discount:ke,discountDesc:yi,creditUsed:Et,total:Ne}=e;ke===0?E.hide():(E.show(),P.setText(j(ke)),y.setText(yi||"")),De===0?M.hide():(M.show(),ee.setText(j(De)),R.setText(pi||"")),gt===Ne&&ke===0&&De===0?(n.hide(),pt.setText(wt)):(n.show(),m.setText(j(gt)),s.setText(wt||""),pt.setText("Total")),ui.setText(j(Et)),k.toggle(Et!==0);let te=Ne===0;hi.toggle(!te),fi.toggle(!te),yt.toggleClass("mod-no-card",te),yt.setText(te?"Pay with credit":"Pay"),Re=te?"credit":"card",mi.setText(j(Ne))},x=function(e){e?(fishAll("button.submit").forEach(t=>t.addClass("mod-disabled")),fishAll(".spinner").forEach(t=>t.removeClass("hidden")),fishAll(".button-text").forEach(t=>t.addClass("hidden"))):(fishAll("button.submit").forEach(t=>t.removeClass("mod-disabled")),fishAll(".spinner").forEach(t=>t.addClass("hidden")),fishAll(".button-text").forEach(t=>t.removeClass("hidden")))},Z=()=>a(void 0,null,function*(){Re==="card"?ti(v,yield me("card")):Re==="credit"&&(yield me("card"),dt())}),oi=()=>a(void 0,null,function*(){let e;try{e=yield c(Ei,{})}catch(t){ce||(f.hide(),u.show());return}St.setText(e.name),Pt.setText(e.email),e.donation&&Mn.setText(j(e.donation)),l.hide(),f.hide(),d.show(),e.license&&(V=e.license),V?(Ze.addClass("is-active"),sn.setText(e.license),V!=="vip"&&(Je.addEventListener("click",()=>{r=fish(".modal-container.mod-personal-license .payment-error"),Qe.show()}),Je.show(),V==="supporter"?(et.hide(),cn.hide()):V==="insider"&&et.hide())):Ze.addEventListener("click",()=>{r=fish(".modal-container.mod-personal-license .payment-error"),Qe.show()}),Sn.toggle(e.credit!==0),Pn.setText(j(e.credit))}),li=()=>a(void 0,null,function*(){let e=yield c(Ri,{});if(e.business&&e.business.expiry>=Date.now()){D=e.business,S.setText(D.key),on.setText(D.company);let t=D.seats,n=t===1?"1 seat":t+" seats";ln.forEach(s=>s.setText(n)),Nn.forEach(s=>s.setText(new Date(D.expiry).toLocaleDateString())),tn.hide(),nn.show()}else Ve.addEventListener("click",()=>{p="business",w=parseInt(q.value).toString(),r=fish(".modal-container.mod-commercial-license .payment-error"),ye.show(),v.mount(".modal-container.mod-commercial-license .card-element"),Ae()});if(e.publish){let{sites:t,renew:n,renew_sites:s,expiry_ts:m,earlybird:E}=e.publish;if(m>=Date.now()){if(Ue.addClass("is-active"),t===1?Be.setText("1 site"):Be.setText(`${t} sites`),s===1?(Oe.setText("1 site"),pe.hide()):(Oe.setText(`${s} sites`),pe.show()),m){let P=new Date(m);zt.forEach(M=>M.setText(`on ${P.toLocaleDateString()}`))}Ye.hide();let y=document.createDocumentFragment();n==="yearly"?(Ke.hide(),y.createSpan({text:"You're currently on a "}),y.createSpan({cls:"u-pop",text:"yearly"}),y.createSpan({text:" plan."})):n==="monthly"?(Xe.hide(),y.createSpan({text:"You're currently on a "}),y.createSpan({cls:"u-pop",text:"monthly"}),y.createSpan({text:" plan."})):n===""&&(ze.hide(),Ye.show(),$t.hide(),y.createSpan({text:"You're not currently being renewed."})),We.empty(),We.appendChild(y),Ge.value=t}E===!0&&(fish(".publish-yearly-price-per-month").setText("8"),fish(".publish-yearly-price-per-year").setText("96"),fish(".publish-monthly-price-per-month").setText("10"),fish(".publish-monthly-price-per-year").setText("120"),Ue.addClass("is-early-bird"))}if(e.sync){let{renew:t,expiry_ts:n,earlybird:s}=e.sync;if(n>=Date.now()){if(Fe.addClass("is-active"),n){let E=new Date(n);Dn.forEach(y=>y.setText(`on ${E.toLocaleDateString()}`))}Se.hide(),t==="yearly"||(t==="monthly"?xe.hide():t===""&&(Ce.hide(),Se.show(),at.hide()));let m=document.createDocumentFragment();t==="yearly"?(Le.hide(),m.createSpan({text:"You're currently on a "}),m.createSpan({cls:"u-pop",text:"yearly"}),m.createSpan({text:" plan."})):t==="monthly"?(xe.hide(),m.createSpan({text:"You're currently on a "}),m.createSpan({cls:"u-pop",text:"monthly"}),m.createSpan({text:" plan."})):t===""&&(Ce.hide(),Se.show(),at.hide(),m.createSpan({text:"You're not currently being renewed."})),st.empty(),st.appendChild(m)}s===!0&&(fish(".sync-yearly-price-per-month").setText("4"),fish(".sync-yearly-price-per-year").setText("48"),fish(".sync-monthly-price-per-month").setText("5"),fish(".sync-monthly-price-per-year").setText("60"),Fe.addClass("is-early-bird"))}if(e.business){let{renew:t,expiry:n}=e.business;if(n>=Date.now()){if(Ve.addClass("is-active"),n){let s=new Date(n);kn.forEach(m=>m.setText(`on ${s.toLocaleDateString()}`))}re.hide(),t==="yearly"?(Pe.hide(),se.show(),re.hide(),Me.show()):t===""&&(Pe.show(),se.hide(),re.show(),Me.hide()),t==="yearly"?Le.hide():t===""&&(se.hide(),re.show(),Me.hide())}}}),ai=()=>a(void 0,null,function*(){i.hide(),u.hide(),f.show();let e=g.value,t=A.value,n=!1;if(e===""?(i.setText("Email cannot be empty."),n=!0):e.indexOf("@")===-1?(i.setText("Email is not valid."),n=!0):t===""&&(i.setText("Password cannot be empty."),n=!0),n){u.show(),f.hide(),i.show();return}try{yield c(bi,{email:g.value,password:A.value}),window.location.reload()}catch(s){u.show(),f.hide(),s==="Login failed"&&(i.setText("Login failed, please double check your email and password."),i.show())}}),si=()=>a(void 0,null,function*(){o.hide(),l.hide(),f.show();let e=K.value,t=C.value,n=W.value,s=!1;if(e===""?(o.setText("Name cannot be empty."),s=!0):t===""?(o.setText("Email cannot be empty."),s=!0):t.indexOf("@")===-1?(o.setText("Email is not valid."),s=!0):n===""&&(o.setText("Password cannot be empty."),s=!0),s){o.show(),l.show(),f.hide();return}try{yield c(Ti,{name:e,email:t,password:n}),window.location.reload()}catch(m){l.show(),f.hide(),m==="Invalid email address"?o.setText("The email address you entered was invalid."):m==="Already signed up"&&o.setText("Seems like you already have an account! Please log in."),o.show()}}),ri=()=>a(void 0,null,function*(){F.hide(),we.hide();let e=yn.value;if(e){if(e.indexOf("@")===-1){F.setText('Email address is not valid and must contain "@".'),F.show();return}}else{F.setText("Please fill out your email."),F.show();return}f.show();try{yield c(xi,{email:e,captcha:"captcha"}),we.setText(`We have sent an email to ${e} to reset your password.`),we.show(),gn.hide(),En.hide(),f.hide()}catch(t){F.setText("Something went wrong, please try again."),F.show(),f.hide()}}),ci=()=>a(void 0,null,function*(){Ee.hide(),$.hide();let e=wn.value;if(!e){$.setText("Please set a new password."),$.show();return}try{yield c(Li,{password:e,id:rt,key:ct}),Ee.innerHTML='Your password has been successfully set. <a href="/account">Log in</a>',Ee.show()}catch(t){$.setText("Something went wrong, please try again."),$.show()}}),di=()=>a(void 0,null,function*(){yield c(vi,{}),window.location.reload()}),me=e=>a(void 0,null,function*(){try{return(yield c(xt,{type:p,variation:w,renew:I,method:e})).secret}catch(t){throw r.setText(t),r.show(),t}}),Ae=()=>a(void 0,null,function*(){X&&(w=(parseInt(w)+D.seats).toString()),r.hide();try{let e=yield c(ne,{type:p,variation:w});ue(e,fish(".modal-container.mod-commercial-license")),J("business")}catch(e){r.setText(e),r.show()}});oi(),li(),Gt.addEventListener("click",()=>{di()});let Ie=()=>{let e=S.getText();bt(e),S.setText("Copied!"),S.addClass("is-copied"),S.removeEventListener("click",Ie),setTimeout(()=>{S.removeClass("is-copied"),S.setText(e),S.addEventListener("click",Ie)},500)};S.addEventListener("click",Ie),q.addEventListener("input",()=>{if(p="business",q.value===""||X&&parseInt(q.value)===0)return;w=parseInt(q.value).toString(),Ae()}),ge.forEach(e=>{e.addEventListener("click",()=>a(void 0,null,function*(){if(ge.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),p="catalyst",w=e.getAttribute("data-tier"),!!["insider","supporter","vip"].contains(w))try{let t=yield c(ne,{type:p,variation:w});ue(t,fish(".modal-container.mod-personal-license")),it.show(),v.mount(".modal-container.mod-personal-license .card-element"),J("catalyst")}catch(t){r.setText(t),r.show()}}))}),rn.forEach(e=>{e.addEventListener("click",L)}),hn.addEventListener("click",()=>{location.hash="#mode=signup",location.reload()}),fn.addEventListener("click",()=>{location.hash="",location.reload()}),pn.addEventListener("click",()=>{location.hash="#mode=forgotpass",location.reload()}),u.find("form").addEventListener("submit",e=>{e.preventDefault(),ai()}),l.find("form").addEventListener("submit",e=>{e.preventDefault(),si()}),tt.find("form").addEventListener("submit",e=>{e.preventDefault(),ri()}),nt.find("form").addEventListener("submit",e=>{e.preventDefault(),ci()});let he=()=>a(void 0,null,function*(){let e=be.filter(s=>s.hasClass("is-selected"));if(e.length===0)return;let t=e[0].getAttribute("data-renew"),n=ot.value.toString();p="publish",w=n,I=t,r.hide();try{let s=yield c(ne,{type:"publish",renew:t,variation:n});ue(s,fish(".modal-container.mod-choose-publish-plan")),J("publish")}catch(s){r.setText(s),r.show()}}),ut=()=>a(void 0,null,function*(){let e=ve.filter(n=>n.hasClass("is-selected"));if(e.length===0)return;let t=e[0].getAttribute("data-renew");p="sync",I=t,r.hide();try{let n=yield c(ne,{type:"sync",renew:t});ue(n,ae),J("sync")}catch(n){r.setText(n),r.show()}});bn.addEventListener("click",()=>{le.show(),v.mount(".modal-container.mod-choose-publish-plan .card-element"),r=fish(".modal-container.mod-choose-publish-plan .payment-error"),he()}),be.forEach(e=>{e.addEventListener("click",()=>{be.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),he()})}),ot.addEventListener("change",()=>{he()}),xn.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),x(!0),Z()}),Xe.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"publish",renew:"monthly"}),window.location.reload()})),Ke.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"publish",renew:"yearly"}),window.location.reload()})),ze.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"publish",renew:""}),window.location.reload()})),Zt.addEventListener("click",()=>{le.show(),v.mount(".modal-container.mod-choose-publish-plan .card-element"),r=fish(".modal-container.mod-choose-publish-plan .payment-error"),he()}),pe.addEventListener("click",()=>{Tn.show()}),en.addEventListener("click",()=>a(void 0,null,function*(){let e=parseInt(Ge.value);yield c(ki,{sites:e}),window.location.reload()})),Vt.forEach(e=>e.addEventListener("click",()=>a(void 0,null,function*(){let t=yield c(Ni,{});t.info?je.setText(`You're currently using a ${t.info}.`):je.setText("You currently do not have any payment methods on file."),vn.show()}))),Qt.forEach(e=>e.addEventListener("click",()=>{qe.show(),r=qe.find(".payment-error"),v.mount(".modal-container.mod-change-payment-method .card-element")})),Jt.addEventListener("submit",e=>{e.preventDefault(),Q.createPaymentMethod({type:"card",card:v}).then(t=>a(void 0,null,function*(){t.paymentMethod&&t.paymentMethod.id?(yield c(_i,{payment_method_id:t.paymentMethod.id}),window.location.reload()):(r.setText("Could not update your payment method."),r.show())}))}),Ln.addEventListener("click",()=>{lt.show(),r=lt.find(".payment-error"),v.mount(".modal-container.mod-donation .card-element"),Te.trigger("change")}),Cn.addEventListener("submit",e=>{e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),x(!0),Z()}),Te.addEventListener("change",()=>{p="donation",w=(Te.valueAsNumber*100).toString(),J("donation")}),An.addEventListener("click",()=>{ae.show(),v.mount(".modal-container.mod-choose-sync-plan .card-element"),r=fish(".modal-container.mod-choose-sync-plan .payment-error"),ut()}),ve.forEach(e=>{e.addEventListener("click",()=>{ve.forEach(t=>t.removeClass("is-selected")),e.addClass("is-selected"),ut()})}),In.addEventListener("submit",function(e){e.preventDefault(),fishAll(".payment-error").forEach(t=>t.hide()),x(!0),Z()}),xe.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"sync",renew:"monthly"}),window.location.reload()})),Le.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"sync",renew:"yearly"}),window.location.reload()})),Ce.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"sync",renew:""}),window.location.reload()})),se.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"business",renew:""}),window.location.reload()})),Pe.addEventListener("click",()=>a(void 0,null,function*(){yield c(N,{type:"business",renew:"yearly"}),window.location.reload()})),_n.forEach(e=>{e.addEventListener("click",()=>{e.hasClass("is-enabled")?e.removeClass("is-enabled"):e.addClass("is-enabled")})}),Hn.forEach(e=>e.addEventListener("click",()=>{let t="823279137640415263",n=location.protocol+"//"+location.host+location.pathname;e.addClass("mod-disabled"),location.href=`https://discord.com/api/oauth2/authorize?client_id=${t}&redirect_uri=${encodeURIComponent(n)}&response_type=code&scope=identify`})),Un.forEach(e=>e.addEventListener("click",()=>a(void 0,null,function*(){e.addClass("mod-disabled");try{yield c(Ui,{}),On.show()}catch(t){qn.setText(t),Yn.show()}e.removeClass("mod-disabled")}))),Mt.addEventListener("click",()=>{Rt.show()}),Dt.addEventListener("click",()=>a(void 0,null,function*(){_.hide();let e=At.value,t=It.value;if(e===""){_.setText("New email cannot be empty."),_.show();return}if(t===""){_.setText("Password cannot be empty."),_.show();return}try{yield c(Si,{password:t,email:e}),L(),T=!0,z.show()}catch(n){_.setText(n),_.show()}})),kt.addEventListener("click",()=>{Nt.show()}),Ht.addEventListener("click",()=>a(void 0,null,function*(){G.hide();let e=_t.value;if(e===""){G.setText("New name cannot be empty."),G.show();return}try{yield c(Ci,{name:e}),L(),T=!0,z.show()}catch(t){G.setText(t),G.show()}})),Ut.addEventListener("click",()=>{Ft.show()}),Yt.addEventListener("click",()=>a(void 0,null,function*(){H.hide();let e=Bt.value,t=Ot.value;if(e===""){H.setText("Current password cannot be empty."),H.show();return}if(e===""){H.setText("New password cannot be empty."),H.show();return}try{yield c(Pi,{old_password:e,new_password:t}),L(),T=!0,z.show()}catch(n){H.setText(n),H.show()}})),jt.addEventListener("click",()=>{qt.show()}),Wt.addEventListener("click",()=>a(void 0,null,function*(){U.hide();let e=Kt.value,t=Xt.value;if(e===""){U.setText("Please enter your email to confirm account deletion."),U.show();return}if(t===""){U.setText("Please enter your password to confirm account deletion."),U.show();return}try{yield c(Mi,{email:e,password:t}),L(),T=!0,z.show()}catch(n){U.setText(n),U.show()}})),Gn.addEventListener("click",()=>{ye.addClass("is-updating"),r=fish(".modal-container.mod-commercial-license .payment-error"),ye.show(),v.mount(".modal-container.mod-commercial-license .card-element"),p="business",w=parseInt(q.value).toString(),X=!0,an.setText("Add seats"),Ae()}),zn.addEventListener("click",()=>{$n.show()}),Qn.addEventListener("click",()=>a(void 0,null,function*(){B.hide();let e=Vn.valueAsNumber,t=D.seats;if(e===0){B.setText("The number of seats to remove cannot be 0."),B.show();return}let n=t-e;if(n<0){let s=t===1?"1 seat":t+" seats";B.setText("You currently have "+s+" and cannot remove more seats than that."),B.show();return}try{yield c(Di,{seats:n}),L(),T=!0,z.show()}catch(s){B.setText(s),B.show()}}));let mt="",ht="stripe",ft=fish(".modal-container.mod-invoice-list");fish(".js-view-invoices").addEventListener("click",()=>a(void 0,null,function*(){f.show(),d.hide();let e=yield c(Fi,{});f.hide(),d.show(),ft.show();let t=ft.find(".invoice-list");t.empty();for(let n of e)t.createDiv({cls:"invoice-item setting-item"},s=>{s.createDiv({cls:"setting-item-info"},m=>{m.createDiv({text:n.description,cls:"setting-item-name"}),m.createDiv({text:new Date(n.created).toLocaleString(),cls:"setting-item-description"})}),s.createDiv({cls:"setting-item-control mod-vertical"},m=>{m.createEl("button",{cls:"mod-cta",text:"View"},E=>{E.addEventListener("click",()=>{let y=(n.amount/100).toFixed(2),P=(n.refunded/100).toFixed(2),M=((n.amount-n.refunded)/100).toFixed(2),R=n.refunded!==0,ee=localStorage.getItem("billing-info");fish(".invoice-date").setText(new Date(n.created).toLocaleString()),fish(".invoice-number-title").setText(n.receipt_number||n.id),fish(".invoice-number").setText(n.receipt_number||n.id),fish(".invoice-description").setText(n.description),fish(".invoice-amount").setText(y),R?(fish(".invoice-box .item.mod-refund").show(),fish(".invoice-refund-amount").setText(P)):fish(".invoice-box .item.mod-refund").hide(),fish(".invoice-total").setText(M),ee&&fish(".billing-info").setText(ee),fish(".billing-info").addEventListener("input",()=>{let k=fish(".billing-info").getText();localStorage.setItem("billing-info",k)}),fish(".modal-container.mod-invoice-detail").show()})}),n.refundable&&m.createEl("a",{text:"Get refund"},E=>{E.addEventListener("click",()=>{mt=n.id,ht=n.type,fish(".modal-container.mod-confirm-refund").show()})})})})})),fish(".js-confirm-refund").addEventListener("click",()=>a(void 0,null,function*(){fish(".modal-container.mod-invoice-list").hide(),fish(".modal-container.mod-confirm-refund").hide(),f.show(),d.hide();try{yield c(Bi,{charge:mt,type:ht}),T=!0,fish(".modal-container.mod-refund-success").show()}catch(e){fish(".refund-failed-reason").setText(e),fish(".modal-container.mod-refund-failed").show()}f.hide(),d.show()})),Jn.forEach(e=>e.addEventListener("click",()=>{Zn.show()}))});})();
