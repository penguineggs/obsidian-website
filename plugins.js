(()=>{var I=(e,t)=>e[0]-t[0];function T(e){if(e.length===0)return e;e.sort(I);let t=[e[0]];for(let r=1;r<e.length;r++){let l=t.last();l[1]<e[r][0]?t.push(e[r]):l[1]<e[r][1]&&(l[1]=e[r][1])}return t}function F(e,t,r,l){if(e.length===0)return 0;let i=0;i-=Math.max(0,e.length-1),i-=l/10;let s=e[0][0];return i-=(e[e.length-1][1]-s+1-t)/100,i-=s/1e3,i-=r/1e4,i}function H(e,t){let r=t.toLowerCase(),l=[];for(let i of e){if(!i)continue;let s=!1,a=-1,n=i.length;for(;(a=r.indexOf(i,a))!==-1;)s=!0,l.push([a,a+n]),a+=n+1;if(!s)return null}return T(l)}function E(e,t,r){let l=H(e,r);return l?{score:F(l,t.length,r.length,0),matches:l}:null}function v(e,t,r,l=0){if(!r){e.appendText(t);return}let i=0;for(let s=0;i<t.length&&s<r.length;s++){let a=r[s],n=a[0]+l,u=a[1]+l;if(!(u<=0)){if(n>=t.length)break;n<0&&(n=0),n!==i&&e.appendText(t.substring(i,n)),e.createSpan({cls:"suggestion-highlight",text:t.substring(n,u)}),i=u}}i<t.length&&e.appendText(t.substring(i))}function w(e){if(!navigator.clipboard||!navigator.permissions){let t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t);try{t.focus(),t.select(),document.execCommand("copy")}catch(r){}document.body.removeChild(t);return}navigator.clipboard.writeText(e)}var j=window.requestIdleCallback;var B=/bot|crawl|spider/i.test(navigator.userAgent);function M(e,t,r){return"https://raw.githubusercontent.com/"+e+"/"+(r||"HEAD")+"/"+t}var Y=M("obsidianmd/obsidian-releases","community-plugins.json");async function L(){let e=await ajaxPromise({url:Y}),t=JSON.parse(e);if(!Array.isArray(t))throw new Error("Failed to parse community plugins.");return t}var X=M("obsidianmd/obsidian-releases","community-plugin-stats.json");async function S(){let e=await ajaxPromise({url:X});try{return JSON.parse(e)}catch(t){throw t}}var V=M("obsidianmd/obsidian-releases","community-css-themes.json");function N(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function C(e,t,r){return r||(r=t+"s"),e===1?e+" "+t:N(e)+" "+r}var h="";try{let e=new URLSearchParams(location.search);h=e.get("id"),h?setTimeout(()=>{location.href="obsidian://show-plugin?id="+encodeURIComponent(h)},0):h=e.get("search")}catch(e){console.error(e)}h=h||"";(async()=>{let e=n=>{let u=n.length,d;for(;u!==0;)d=Math.floor(Math.random()*u),u--,[n[u],n[d]]=[n[d],n[u]];return n},t=fish(".plugins-container"),r=fish(".plugin-count"),l=fish(".plugin-search"),i=await L(),s=await S();r.setText(String(i.length)),e(i);function a(n){n=(n||"").trim();let u=n.toLowerCase().split(" ");t.empty();let d=[];for(let o of i){let c=-1/0,m,g,p;if(n){if(m=E(u,n,o.name),g=E(u,n,o.description),p=E(u,n,o.author),!m&&!g&&!p&&n!==o.id.toLowerCase())continue;m&&(c=Math.max(m.score,c)),g&&(c=Math.max(g.score,c)),p&&(c=Math.max(p.score,c))}let P=createDiv({cls:"subfeature"},y=>{let R=y.createDiv({cls:"subfeature-title u-center-text"});v(R,o.name,m?m.matches:null),y.createEl("p",{cls:"author-container u-center-text",text:"By "},b=>{let f=b.createEl("span",{cls:"author-name"});v(f,o.author,p?p.matches:null)});let D=s[o.id].downloads,A=y.createEl("p",{cls:"u-muted"});v(A,o.description,g?g.matches:null),y.createEl("div",{cls:"u-center-text"},b=>{b.createEl("button",{cls:"mod-cta",text:"Learn more"},f=>{f.addEventListener("click",()=>{window.open("https://github.com/"+o.repo,"_blank")})}),b.createEl("p",{cls:"u-muted",text:`${C(D,"download")}`}),b.createEl("p",{},f=>{f.createEl("a",{cls:"u-muted",text:"Open in Obsidian"},x=>{x.setAttribute("href","#"),x.addEventListener("click",()=>{location.href="obsidian://show-plugin?id="+encodeURIComponent(o.id)})}),f.appendText(" "),f.createEl("a",{cls:"u-muted",text:"Copy link to share"},x=>{x.setAttribute("href","#"),x.addEventListener("click",()=>{w("https://obsidian.md/plugins?id="+encodeURIComponent(o.id))})})})})});d.push({score:c,el:P})}d.sort(function(o,c){return o.score-c.score});for(let o of d)t.appendChild(o.el)}l.value=h,a(h),l.addEventListener("input",()=>{let n=l.value;a(n),window.history.replaceState(null,null,`?search=${n}`)})})();})();
