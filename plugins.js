(()=>{function F(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function T(e,t,r){return r||(r=t+"s"),e===1?e+" "+t:F(e)+" "+r}var H=(e,t)=>e[0]-t[0];function L(e){if(e.length===0)return e;e.sort(H);let t=[e[0]];for(let r=1;r<e.length;r++){let i=t.last();i[1]<e[r][0]?t.push(e[r]):i[1]<e[r][1]&&(i[1]=e[r][1])}return t}function Y(e,t,r,i){if(e.length===0)return 0;let l=0;l-=Math.max(0,e.length-1),l-=i/10;let s=e[0][0];return l-=(e[e.length-1][1]-s+1-t)/100,l-=s/1e3,l-=r/1e4,l}function X(e,t){let r=t.toLowerCase(),i=[];for(let l of e){if(!l)continue;let s=!1,o=-1,n=l.length;for(;(o=r.indexOf(l,o))!==-1;)s=!0,i.push([o,o+n]),o+=n+1;if(!s)return null}return L(i)}function E(e,t,r){let i=X(e,r);return i?{score:Y(i,t.length,r.length,0),matches:i}:null}function v(e,t,r,i=0){if(!r){e.appendText(t);return}let l=0;for(let s=0;l<t.length&&s<r.length;s++){let o=r[s],n=o[0]+i,u=o[1]+i;if(!(u<=0)){if(n>=t.length)break;n<0&&(n=0),n!==l&&e.appendText(t.substring(l,n)),e.createSpan({cls:"suggestion-highlight",text:t.substring(n,u)}),l=u}}l<t.length&&e.appendText(t.substring(l))}function S(e,t=0,r=!1){let i=null,l=null,s=null,o=0,n=function(){if(o){let c=Date.now();if(c<o){i=window.setTimeout(n,o-c),o=0;return}}i=null;let h=l,a=s;l=null,s=null,e.apply(h,a)},u=function(...h){l=this,s=h,i?r&&(o=Date.now()+t):i=window.setTimeout(n,t)};return u.cancel=function(){return i&&(clearTimeout(i),i=null),u},u}function C(e){if(!navigator.clipboard||!navigator.permissions){let t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t);try{t.focus(),t.select(),document.execCommand("copy")}catch(r){}document.body.removeChild(t);return}navigator.clipboard.writeText(e)}var K=window.requestIdleCallback;var W=/bot|crawl|spider/i.test(navigator.userAgent);function M(e,t,r){return"https://raw.githubusercontent.com/"+e+"/"+(r||"HEAD")+"/"+t}var N=M("obsidianmd/obsidian-releases","community-plugins.json");async function P(){let e=await ajaxPromise({url:N}),t=JSON.parse(e);if(!Array.isArray(t))throw new Error("Failed to parse community plugins.");return t}var k=M("obsidianmd/obsidian-releases","community-plugin-stats.json");async function R(){let e=await ajaxPromise({url:k});try{return JSON.parse(e)}catch(t){throw t}}var J=M("obsidianmd/obsidian-releases","community-css-themes.json");var d="";try{let e=new URLSearchParams(location.search);d=e.get("id"),d?setTimeout(()=>{location.href="obsidian://show-plugin?id="+encodeURIComponent(d)},0):d=e.get("search")}catch(e){console.error(e)}d=d||"";(async()=>{let e=n=>{let u=n.length,h;for(;u!==0;)h=Math.floor(Math.random()*u),u--,[n[u],n[h]]=[n[h],n[u]];return n},t=fish(".plugins-container"),r=fish(".plugin-count"),i=fish(".plugin-search"),l=await P(),s=await R();r.setText(String(l.length)),e(l);function o(n){n=(n||"").trim();let u=n.toLowerCase().split(" ");t.empty();let h=[];for(let a of l){let c=-1/0,m,g,p;if(n){if(m=E(u,n,a.name),g=E(u,n,a.description),p=E(u,n,a.author),!m&&!g&&!p&&n!==a.id.toLowerCase())continue;m&&(c=Math.max(m.score,c)),g&&(c=Math.max(g.score,c)),p&&(c=Math.max(p.score,c))}let D=createDiv({cls:"subfeature"},y=>{let A=y.createDiv({cls:"subfeature-title u-center-text"});v(A,a.name,m?m.matches:null),y.createEl("p",{cls:"author-container u-center-text",text:"By "},b=>{let f=b.createEl("span",{cls:"author-name"});v(f,a.author,p?p.matches:null)});let w=s[a.id].downloads,I=y.createEl("p",{cls:"u-muted"});v(I,a.description,g?g.matches:null),y.createEl("div",{cls:"u-center-text"},b=>{b.createEl("button",{cls:"mod-cta",text:"Learn more"},f=>{f.addEventListener("click",()=>{window.open("https://github.com/"+a.repo,"_blank")})}),w&&b.createEl("p",{cls:"u-muted",text:`${T(w,"download")}`}),b.createEl("p",{},f=>{f.createEl("a",{cls:"u-muted",text:"Open in Obsidian"},x=>{x.setAttribute("href","#"),x.addEventListener("click",()=>{location.href="obsidian://show-plugin?id="+encodeURIComponent(a.id)})}),f.appendText(" "),f.createEl("a",{cls:"u-muted",text:"Copy link to share"},x=>{x.setAttribute("href","#"),x.addEventListener("click",()=>{C("https://obsidian.md/plugins?id="+encodeURIComponent(a.id))})})})})});h.push({score:c,el:D})}h.sort(function(a,c){return a.score-c.score});for(let a of h)t.appendChild(a.el)}i.value=d,o(d),i.addEventListener("input",S(()=>{let n=i.value;o(n),n!==""?window.history.replaceState(null,null,`?search=${n}`):window.history.replaceState(null,null,window.location.pathname)},100))})();})();
